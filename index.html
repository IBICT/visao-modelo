<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Mapa Completo do Sistema de Observatorio</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css">
    <style>

html,
body {
    height: 100%;
}
.form-check-label {
    line-height: 2;
}

.Newgradientbuttons{
    
    width:20px;
    height:60px;
    background: #FFFFFF;
    box-shadow: 4px 4px 4px rgba(0, 0, 0, 0.05);
    border-radius: 27px;
    position: relative;
    right: 75px;
    bottom: -28px;
}

.NewgradientbuttonClass{
    transform: rotate(90deg);
    border-radius: 27px;
    height: 12px;
    width: 12px;
    margin: 6px 4px;
    top: 5px;
    position: relative;
}
.miniInfoPopup{
    background: #F2F2F2;
    box-shadow: -4px 4px 8px rgba(0, 0, 0, 0.15);
    border-radius: 5px;
    position: relative;
    flex: 1 1 auto;
    padding: 1rem;
    width: 13rem;
    bottom: 3rem; 
    position: absolute;
    height: max-content;
}

#link-fonte2{
    margin-bottom: 0;
    margin-top: 1rem;
    font-family: Roboto;
    font-style: italic;
    font-weight: normal;
    font-size: 12px;
    line-height: 14px;
    text-decoration-line: underline;

    color: #268DA6;
}

.info-sobre-ind2{

    font-family: Roboto;
    font-style: normal;
    font-weight: normal;
    font-size: 12px;
    line-height: 14px;
    text-align: justify;
    color: #4F4F4F;
}

.titleInfoInd1{
    font-family: Roboto;
    font-style: normal;
    font-weight: 500;
    font-size: 12px;
    line-height: 14px;

    color: #59C9A8;
}

.titleInfoInd2{
    font-family: Roboto;
    font-style: normal;
    font-weight: normal;
    font-size: 12px;
    line-height: 14px;

    color: #59C9A8;
}


#PIB{
    top: 1.8rem;
    width: max-content;
}

#dados-rendimentoMedio{
    font-family: "Roboto Condensed";
    font-style: normal;
    font-weight: 300;
    font-size: 28px;
    line-height: 33px;
    letter-spacing: 0.1em;

    color: #146678;
}

#infosGerais{
    font-family: 'Roboto Condensed';
    font-style: normal;
    font-weight: bold;
    font-size: 22px;
    line-height: 26px;
    /* identical to box height */
    color: #E5C759;
}

.divsPopup{
    padding: 18px 0px;
    margin: 0px 35px;
}

#basic-addon1{
    background: #FEFFFF;
    border-radius: 5px 0px 0px 5px;
    margin-right:5px;
    position: absolute;
    bottom: 0px;
}

.Escolha-estMun-titulo{
    font-family: 'Roboto Condensed';
    font-style: normal;
    font-weight: 300;
    font-size: 16px;
    line-height: 19px;
    color: #146678;
}

.iconeTarget{
    color: #59C9A8;
    font-size: 14px;
    padding-right: 6px;
}

.opcaoEstados {

    background: #FFFFFF;
    
}

.parteEstMun{
    background: #FFFFFF;
    bottom: 0%;
    position: absolute;
    left: 35px;
    display: none;
    background: #FFFFFF;
    border-radius: 5px 5px 5px 0px;
}

.estMun {
    
    position: relative;
    margin: 0;
    width: 200px;
    padding: 0 10px;
    list-style-type: none;

}

.estMun > li{
    width: max-content;
    border: 1px solid white;
    line-height: 25px;
    font-size: 14px;
    padding: 0 10px;
    cursor: pointer;
}

#escolhaEstMun {
    background: #FFFFFF;
    border-radius: 0px 5px 5px 0px;
    width: max-content;
    height: 30px;
    bottom: 0px;
    position: absolute;
    left: 35px;
}
/*  
janela pop-up info sobre indicadores 
 */

 .parteGradientes {
    position: absolute;
    bottom: 2rem;
    right: -0.2rem;
    padding: 0 10px;
    

}
.opcaoGradientes {

width: 200px;
padding: 0 10px;
}

#opcaoGradiente>option:hover {
background-color: transparent;

}




.gradient_selector {
    width: 200px;
    background: #222;
    color:  black;
    line-height: 25px;
    font-size: 14px;
    padding: 0 10px;
    cursor: pointer;
}

.gradientes {
    display: none;
    position: relative;
    margin: 0;
    width: 200px;
    padding: 0 10px;
    list-style-type: none;
}

.gradientes > li {
    width: 195px;
    border: 1px solid white;
    line-height: 25px;
    font-size: 14px;
    padding: 0 10px;
    cursor: pointer;
}

.gradientes li:hover {
    border: 1px solid black;
}

.opcaoGradientes {
    width: 200px;
    padding: 0 10px;
}

#opcaoGradiente1 {
    background: #d4e76e;
}

#opcaoGradiente2 {
    background: #F19C44;
}

#opcaoGradiente3 {
    background: #e66361;
}



#divGrafInfoInd {
    position:relative;
    margin: 2rem;
}

#info-selecionado {
    font-weight: 300;
    font-size: 24px;
    line-height: 28px;
 }

.icones {
    color: #E5C75A;
    font-style: normal;
    font-weight: 300;
}

.info-sobre-ind {
    font-family: 'Roboto';
    font-style: normal;
    font-weight: normal;
    font-size: 20px;
    line-height: 23px;

    color: #4F4F4F;
}

/* janela pop-up  
foram feitas alterações no .modal-body tambem
*/

#Médiarendimentohomens {
    position: relative;
    font-weight: bold;
}

#Médiarendimentomulheres {
    position: relative;
    font-weight: bold;
}

#infosPieChart {
    font-size: 130%;
    left: 8rem; 
    position:absolute;
}

#Populaçãototal {
    font-size: 23px; 
    position: relative;
    left: 1rem;
    
}

#modalEstadoUF {
    font-size: 50px;
    line-height: 59px;
}

#modalInfo {
    font-family: 'Roboto';
    font-style: normal;
    font-weight: normal;
    font-size: 30px;
    line-height: 25px;
    color: #3D3D3D;
    position: absolute;
    padding: 0px 0px 0px 20px;
}

#modalEstado{
    /* background: #e5c75a; */
    position:relative;
    color: #146678;
    font-family: Roboto Condensed;
    font-style: normal;
    font-weight: bold;
    font-size: 28px;
    line-height: 33px;
}

.arrowCss {
    position: relative;
    float: right;
    left: 2rem;
    color: #146678;
}

.entryDiv1 {
    border-radius: 29px;
    background: #e5c75a;
    width:max-content;
    margin: 0;
    padding: 0;
}

.iconePessoa {
    font-style: normal;
    font-weight: 900;
    font-size: 80px;
    line-height: 92px;
    position: relative;
    color: #E5C75A;
}

.bonecosPop {
    font-style: normal;
    font-weight: 900;
    font-size: 30px;
    line-height: 34px;
    color: #E5C75A;
    padding-right: 0.3rem;
}

#bonecosPopulacao {
    position:relative;
    
    top: 1.1rem;
}

.parte-tabela {
    padding: 0px;
    position: relative;
}

.upper {
    text-transform: uppercase;
}
.botaoContornado {
    position:relative; 
    border: 1px solid #146678;
    box-sizing: border-box;
    border-radius: 5px;
    float: right; 
    left: 2rem; 
    top: 0.1rem;
}

.tabs-label4{

    right: 20px;
}

.tabs-label3{

    right: 52px;
}

.tabs-label2{

    right: 191px;
}

.tabs-label1{

    right: 287px;
}

.tabs {
    width: 738px;
    height: 25px;
    float: none;
    list-style: none;
    position: relative;
    margin: 5px 0 0 10px;
    text-align: left;
    border-bottom-style: outset;
}

.tabs li {
    float: left;
    display: block;
}

.tabs input[type="radio"] {
    position: absolute;
    top: 0;
    left: -9999px;
}

.tabs label {
    display: block;
    padding:0px,10px,20px; 
    border-radius: 2px 2px 0 0;
    font-family: 'Roboto';
    font-style: normal;
    font-weight: normal;
    font-size: 16px;
    line-height: 20px;
    text-align: center;
    color: #146678;
    cursor: pointer;
    position: absolute;
    top: 4px;
    -moz-transition: all 0.2s ease-in-out;
    -o-transition: all 0.2s ease-in-out;
    -webkit-transition: all 0.2s ease-in-out;
    transition: all 0.2s ease-in-out;
}

.tabs .tabs-content {
    z-index: 3;
    display: none;
    overflow: hidden;
    width: 100%;
    font-size: 17px;
    line-height: 25px;
    padding: 25px;
    position: relative;
    top: 1.5rem;
    left: -1rem;
  
}

.tabs [id^="tab"]:checked + label {
    top: 0;
    padding-top: 3px;
    background: #146678;
    color: #FFFFFF;
}

.tabs [id^="tab"]:checked ~ [id^="tab-content"] {
    display: block;
}

.modal-title {
    
    font-family: 'Roboto Condensed';
    font-style: normal;
    font-weight: 300;
    font-size: 24px;
    line-height: 28px;
    color: #FFFFFF;

}

.modal-dadosgerais {
    position: relative;
    width: 41rem;
    height: 25rem;

}

.modal-dados1 {
    position: relative;
    width: 27rem;
    height: 3.4rem;

    
}

.modal-dados2 {
    position: relative;
    width: 15.7rem;
    height: 5rem;   
    top: 5rem;
    
}
.modal-dados3 {
    position: relative;
    width: 19rem;
    height: 5.3rem;   
    left: 21rem;
    
}
.modal-dados4 {
    position: relative;
    padding: 2rem 0rem 1rem 0rem;
    display: inline-block;

    /* display: flex;
    justify-content: space-around; */
    
    
}

.modal-dados5 {
    position: relative;
    width: 19.5rem;
    height: 6.9rem;
    float: right;
    display: none;
}

.canvasjs-chart-container {

    width: 10px;
    height: 10px;

}

.canvasjs-chart-canvas {
    position: relative;
    width: 6.9rem !important;
    height: 6.9rem !important;  
    
}

#link-fonte {
    position: relative;
    margin-bottom: 0rem;
    padding-top: 1rem;
    font-family: 'Roboto';
    font-style: normal;
    font-weight: 500;
    font-size: 12px;
    line-height: 14px;
    color: #59C9A8;
}

.dados-dinheiro {
    font-family: 'Roboto';
    font-style: normal;
    font-weight: 500;
    font-size: 18px;
    line-height: 21px;
    color: #4F4F4F;
    position: absolute;
}

.dados-nome-titulo {
    font-family: 'Roboto Condensed';
    font-style: normal;
    font-weight: normal;
    font-size: 20px;
    
    color: #146678;
}

.dados-nome {
    font-family: 'Roboto Condensed';
    font-style: normal;
    font-weight: 300;
    font-size: 28px;
    line-height: 33px;
    color: #146678;
}


#map {
    width: 100%;
    height: 100%;
    z-index: 1;
    position: fixed;
    top: 0;
    background-color: #132d38;
}

.rangeBarControl .fa-minus {
    position: relative;
    right: 45px;
    top: 14px;
    color: white;
}

.rangeBarControl .fa-plus {
    position: relative;
    left: 190px;
    bottom: 14px;
    color: white;
}

.range-bar {
    position: relative;
    right: 20px;
    height: 10px;
    width: 200px;
    border-radius: 50px;
    background-image: linear-gradient(to right, #d4e76e, #b9e17b, #9dda88 ,  #83d494 , #6acda0,#66baae,  #789abc ,   #897cca,  #9764d5 , #a64cdf );
}
.range-bar-mark {
    position: relative;
    top: -4px;
    left: 0%;
    border: 2px solid whitesmoke;
    border-radius: 50%;
    padding: 0px 7.5px;
    display: none;
}
.select-year {
    position: relative;
    right: 180px;
    bottom: 14px;
    border-radius: 5px 5px 5px 5px;
    outline: none;
    padding-left: 5px;
}
.select-year:hover {
    border-radius: 0 0 5px 5px;
}
.key path {
    display: none;
}
.navbar {
    background-color: rgba(20, 102, 120, 0.8) !important;
    color: white;
    opacity: 0.8;
    z-index: 2;
    top: 0;
    /* display: none; */
}
.navbar nav a {
    color: white;
}
.leaflet-bar button,
.leaflet-bar button:hover,
.input-leaflet {
    color: #59c9a8;
}
.leaflet-top .leaflet-control-layers.leaflet-control {
    position: relative;
    /*top: 77.8vh;*/
    width: 30px;
    height: 30px;
}
.leaflet-control-layers-toggle {
    /* descomentado a linha abaixo, mas nao sei o que faz. Danilo */
    background-image: url(../content/images/mapas.png)!important; 
    width: 30px !important;
    height: 30px !important;
}
.leaflet-control-layers-expanded:first-child {
    /*position: absolute !important;
    top: 65.5vh !important; */
    width: 180px !important;
    height: 150px !important;

}
.title-popup {
    color: #3d3d3d;
    font-size: 15px;
    font-weight: bold;
}
.button-popup {
    background-color: #146678;
    -webkit-border-radius: 29px;
    border-radius: 29px;
    color: white;
    border: 0;
    padding: 0 10px;
    margin-bottom: 2px;
}
.modal-header {
    background-color: #e5c75a;
    color: white;
}
.modal-header .close {
    color: white;
}
.modal-header .close:hover {
    color: white;
}
@media (min-width: 576px) {
    .modal-dialog {
        max-width: None;
        margin: 1%;
    }
}
/* Menu */
.leaflet-top.leaflet-right {
    z-index: 1001 !important;
}
.menu--popup {
    background: #fff;
    position: fixed;
    right: 0px;
    top: 80px;
    width: 340px;
    height: calc(100% - 80px);
    padding: 10px 0.5em 0.5em;
    z-index: 99;
}
.tab-content {
    height: calc(100% - 170px);
}
.nav-tabs {
    border-bottom: 1px solid #59c9a8;
}
.nav-tabs .nav-item {
    margin-bottom: 0;
}
.nav-tabs .nav-link {
    margin-bottom: 0;
    color: #4f4f4f;
    background-color: #f0eded;
    border: none;
}
.nav-tabs .nav-link.active {
    background-color: #fff;
    font-weight: bold;
    color: #59c9a8;
    border-bottom: 1px solid white;
    margin-bottom: -1px;
}
#accordion {
    width: 98%;
}
#accordion .card-body {
    padding: 0rem;
    padding-left: 1.25rem;
    margin-bottom: 1rem;
}
#accordionFilter .card-body {
    padding: 0rem;
    padding-left: 1.25rem;
    margin-bottom: 1rem;
}
#accordionFilter .card-body .form-check-input {
    margin-left: 0rem;
}
.tab-pane {
    overflow-y: scroll;
    height: 100%;
}
.card {
    border: 0;
}
.card-header {
    padding: 0;
}
h5.mb-0 button.btn.btn-link {
    width: 100%;
    height: 100%;
    padding: 12px 6px;
    text-align: left;
    color: #4f4f4f;
    font-weight: bold;
}
.menu {
    font-family: 'Roboto Condensed';
    font-style: normal;
    font-weight: normal;
    font-size: 20px;
    line-height: normal;
    width: 100%;
}
.dropdown-menu.show {
    top: 70px;
    left: -115px
}
.nav-link::after {
    display: none
}
.botao-tam:focus {
    font-family: 'Roboto Condensed';
    font-style: normal;
    font-weight: bold;
    font-size: 20px;
    line-height: 23px;
}
.ajustes {
    position: absolute;
    right: 43%;
    bottom: 35%;
    font-family: 'Roboto Condensed';
}

/* map buttons */
/*.leaflet-left .leaflet-control:first-child,*/
.leaflet-right .leaflet-control:first-child{
    margin-top: 80px;
}
.indicadorMapControl div {
    white-space: nowrap;
}
#menuNav {
    padding: 8px 16px;
    height: 56px;
}

#hoverMouse li {
    height: 30px;
    color: #132d38;
    text-align: left;
    background-color: #fff;
    border-radius: 0.15rem;
}
#hoverMouse li a {
    padding-left: 5px;
    padding-right: 5px;
    color: black;
}
#hoverMouse li a:hover {
    text-decoration: none;
    font-weight: bold;
    background-color: #eee9e9;
}
.fa1 {
    font-size: 1.2rem;
}
.margem {
    margin-right: -12px;
}
.color {
    background-color: white;
    color: black;
}
#altura {
    width: 500px;
}
.titulo-login {
    font-family: 'Roboto Condensed';
    font-weight: bold;
    font-size: 25px;
    line-height: 21px;
    color: #146678;
    margin-bottom: 37px;
    margin-top: 11px;
}
.modal-body {
    height: max-content;
    overflow: auto;
    /*width: 798px;
    /* height: 550px; */
    background: #F2F2F2;
    box-shadow: -4px 4px 8px rgba(0, 0, 0, 0.15);
    border-radius: 5px;
}
.teste {
    width: 75%;
    height: 86%;
    position: absolute;
    top: 8%;
    left: 12.8%;
}
.input-user {
    border-radius: 15px;
    position: relative;
    left: -2%;
}
.esqueci-senha {
    font-family: 'Roboto';
    position: relative;
    left: 69%;
    font-size: 14.5px;
    color: #BDBDBD !important;

}
.conjunto {
    position: relative;
    top: 20px;
}
.cor {
    font-family: 'Roboto Condensed';
    color: #BDBDBD;
    font-size: 15px;
    font-weight: normal;

}
.btn-margem {
    width: 165px;
    margin-left: 160px;
}
.btn-botao {
    color: white;
    width: 165px
}
.btn-botao:hover {
    color: white
}
.fechar {
    position: absolute;
    top: 5px;
    right: 10px;
    font-size: 27px;
    width: 20px;
}
.popup {
    width: 600px;
    position: relative;

}
.form-group {
    margin-bottom: 25px
}
.linkmodal {
    font-weight: bold;
    color: #856404;
}
.linkmodal:hover {
    text-decoration-color: #856404;
    color: inherit;
}
#loading {
    position: fixed;
    top: 45%;
    left: 45%;
    z-index: 999999;
}
.menuMapControl {
    z-index: 99999;
}
.menuMapControl .nav .nav-item a {
    width: auto;
    height: auto;
    line-height: inherit;
}
.iconFilter {
    cursor: pointer;
    padding: 2.5px 10px;
    color: #00697c;
    background-color: #ffffff;

    border-radius: 15px;
    font-size: 10px;
    margin-left: 10px;
    margin-bottom: 10px;
}
.filtroMapControl {
    width: 300px;
}
.iconInfoFilter {
    padding: 2px 10px;
    color: #17a2b8;
    background-color: #e5c75a;
    border-radius: 15px;
    font-size: 14px;
    margin-left: 10px;
    margin-bottom: 10px;
    margin-right: 10px;
}
.filtroMapControl {
    width: 300px;
}
.infoIndicatorSnippet {
    height: 30px;
    overflow: hidden;
}

/* Icones do menu */
.menu-icon {
    padding: 5px;
}
.robotFamily {
    font-family: 'Roboto';
    font-style: normal;
    font-weight: 500;
    line-height: normal;
}
.filtro-selecionado {
    margin-right: 5px;
    padding: 2px 12px;
    background: #59C9A8;
    border-radius: 10px;
    font-family: 'Roboto';
    font-style: normal;
    font-weight: normal;
    font-size: 12px;
    line-height: 14px;
    color: #FFFFFF;
}
.fa-info {
    background-color: #59C9A8;
    padding: 3.5px 6.5px;
    color: white;
    border-radius: 4px;
    font-size: 8px;
    position: relative;
}
.i-icon {
    margin-right: 5px;
}

#sliderOpacidade {
    -webkit-appearance: none;
    width: 100px;
    margin: 3.5px 0;
    display: inline-block;
    padding-bottom: 3px;
}
#sliderOpacidade:focus {
    outline: none;
}
#sliderOpacidade::-webkit-slider-runnable-track {
    width: 100%;
    height: 2px;
    cursor: pointer;
    box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);
    background: #bdbdbd;
    border-radius: 0px;
    border: 0px solid rgba(1, 1, 1, 0);
}
#sliderOpacidade::-webkit-slider-thumb {
    box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);
    border: 0px solid #000000;
    height: 10px;
    width: 10px;
    border-radius: 50px;
    background: #1e7480;
    cursor: pointer;
    -webkit-appearance: none;
    margin-top: -4px;
}
#sliderOpacidade:focus::-webkit-slider-runnable-track {
    background: #bdbdbd;
}
#sliderOpacidade::-moz-range-track {
    width: 100%;
    height: 2px;
    cursor: pointer;
    box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);
    background: #bdbdbd;
    border-radius: 0px;
    border: 0px solid rgba(1, 1, 1, 0);
}
#sliderOpacidade::-moz-range-thumb {
    box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);
    border: 0px solid #000000;
    height: 10px;
    width: 10px;
    border-radius: 50px;
    background: #1e7480;
    cursor: pointer;
}
#sliderOpacidade::-ms-track {
    width: 100%;
    height: 2px;
    cursor: pointer;
    background: transparent;
    border-color: transparent;
    color: transparent;
}
#sliderOpacidade::-ms-fill-lower {
    background: #bdbdbd;
    border: 0px solid rgba(1, 1, 1, 0);
    border-radius: 0px;
    box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);
}
#sliderOpacidade::-ms-fill-upper {
    background: #bdbdbd;
    border: 0px solid rgba(1, 1, 1, 0);
    border-radius: 0px;
    box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);
}
#sliderOpacidade::-ms-thumb {
    box-shadow: 0px 0px 0px rgba(0, 0, 0, 0), 0px 0px 0px rgba(13, 13, 13, 0);
    border: 0px solid #000000;
    height: 10px;
    width: 10px;
    border-radius: 50px;
    background: #1e7480;
    cursor: pointer;
    height: 2px;
}
#sliderOpacidade:focus::-ms-fill-lower {
    background: #bdbdbd;
}
#sliderOpacidade:focus::-ms-fill-upper {
    background: #bdbdbd;
}

#footer-sidebar-filtros {
    position: absolute;
    bottom: 0px;
    right: 0px;
    height: 140px;
    width: 100%;
    background-color: #f5f6f6;
    box-shadow: 0px -1px 5px rgba(0, 0, 0, 0.2);
    border-top: 2px solid #59c9a8;
}

.custom-control-label::before {
    background-color: #fff;
    border: 1px solid #4f4f4f;
    outline-width: 0;
}

.custom-radio .custom-control-input:checked ~ .custom-control-label::before {
    background-color: #fff;
    border: 1px solid #59c9a8;
}

.custom-control-input:checked ~ .custom-control-label::before {
    background-color: #fff;
    border: 1px solid #59c9a8;
}

.custom-checkbox .custom-control-input:checked ~ .custom-control-label::before {
    background-color: #fff;
    border: 1px solid #59c9a8;
}

.custom-control-input:checked ~ .custom-control-label::before {
    background-color: #fff;
    border: 1px solid #59c9a8;
}

.leaflet-container {
    font-family: 'Roboto Condensed';
}

.robotoFamily {
    font-family: 'Roboto' !important;
}

.custom-radio .custom-control-input:checked ~ .custom-control-label::after {
    background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3E%3Ccircle r='3' fill='%2359C9A8'/%3E%3C/svg%3E");
}

.custom-checkbox .custom-control-input:checked ~ .custom-control-label::after {
    background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3E%3Cpath fill='%2359C9A8' d='M6.564.75l-3.59 3.612-1.538-1.55L0 4.26 2.974 7.25 8 2.193z'/%3E%3C/svg%3E");
}

.leaflet-touch .leaflet-control-layers,
.leaflet-touch .leaflet-bar {
    border: none !important;
}
.loader {
    position: relative;
    top: 50%;
    left: 50%;
    -webkit-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
    width: 50px;
    height: 50px;
    background-color: #146678;
    border-radius: 50%;
}
.loader:after {
    content: '';
    position: absolute;
    border-radius: 50%;
    top: 50%;
    left: 50%;
    border: 0px solid white;
    -webkit-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
    -webkit-animation: loading 500ms ease-out forwards infinite;
    animation: loading 500ms ease-out forwards infinite;
}

@-webkit-keyframes loading {
    0% {
        border: 0px solid white;
    }
    20% {
        border: 8px solid white;
        width: 0%;
        height: 0%;
    }
    100% {
        border: 8px solid white;
        width: 100%;
        height: 100%;
    }
}

@keyframes loading {
    0% {
        border: 0px solid white;
    }
    20% {
        border: 8px solid white;
        width: 0%;
        height: 0%;
    }
    100% {
        border: 8px solid white;
        width: 100%;
        height: 100%;
    }
}

/*Loader jose inicio*/

#overlay{
  background: #f2f2f2;
  
  width: 47.7rem;;
    height: 25rem;
  
  
}
.container {
    width: 100%;
    height: 100%;
    position: relative;
  left: 50%;
  top : 50%;
  transform: translate(-50%, -50%);
}
.loadtext{
  position: absolute;
  left: 50%;
  top : 50%;
  transform: translate(-50%, -50%);
  /* animation: fadeinout 1.5s ease-in-out infinite; */
}
/* @keyframes fadeinout {
  0% 100% {
    opacity: 0.5;
  }
  50%{
    opacity: 1;
  }
} */


.spinner {
    
  position:absolute;
  border: solid 1px #0001;
  border-top: solid 1px #2238;
  border-radius: 50%;
  left: 41.8%;
  top: 35%;
  width: 125px;
  height: 125px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/*Jose Loader fim*/

</style>

    
</head>
<body>
    <div id="map">
        <div id ="loading" class="loader"></div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
        
        $("#hide").click(function(){
            console.log("got here");
        $("#modal-dadosgerais").hide();
        $("#hide").hide();
        $("#show").show();
        });
        $("#show").click(function(){
        $("#show").hide();
        $("#hide").show();
        $("#modal-dadosgerais").show();
        });
       
    </script>
    <!-- filtro-selecionado -->

    <div class="modal fade" id="aba-filtro-selecionado" tabindex="-1" role="dialog" aria-labelledby="tituloModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <input id="idInfoIndicador" type="number" style="display: none;">
                    <h5 class="modal-title">INFORMAÇÕES SOBRE INDICADORES</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="padding: 2rem 2rem 1rem 2rem;">
                    <div style="height:4rem; width: max-content;">
                        <span id="info-selecionado" class="dados-nome-titulo upper"></span>
                        <!--
                        <div class='botaoContornado' onclick="mostrargraf(); drawBarChart('columnchart_values2');">
                            <span id="divGrafInfoInd" class='dados-nome-titulo'>Ver gráfico</span>
                        </div>
                        -->
                    </div>
                    <div id="divTextoInfoInd">
                        <div>
                            <div >
                                <p id='descricaoDoIndicador' class="info-sobre-ind"  style="text-align: justify;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec sagittis aliquet nisl, sed maximus justo laoreet in. Etiam iaculis, nisl vel convallis condimentum, nunc eros rutrum quam, vel maximus neque tellus nec enim. Sed et aliquam urna. Fusce varius sagittis ornare. Maecenas tristique mauris eu nisl rutrum, id varius diam auctor. Nullam accumsan blandit varius. Phasellus a ultrices elit.</p>
                            </div>
                        </div>
                        <div id="multipleEntries">
                        </div>
                        <div>
                            <span><p id="link-fonte"><a id='link-popup'>Fonte: NA</a></p></span>
                        </div>
                    </div>
                    <div style="align-content: center; left: 5rem; position: relative;">
                        <i id="columnchart_values2"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
      









    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="tituloModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <input id="idInfoIndicador" type="number" style="display: none;">
                <h5 class="modal-title" id="tituloModal">DETALHAMENTO DE DADOS</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <!-- Inicio das alterações para a tela pop-up -->
                <div class="modal-body" id="modalBody"> 
                    
                    <div class="divsPopup" style="position: relative;">
                        
                        <span class="dados-nome-titulo upper" id="modalEstado"></span>

                    </div>
                    <div id="modalDivInfoEscolhido" class="divsPopup" style="border-style:solid None; border-color:rgba(9, 50, 59, 0.4); border-width: 1px;">
                        <span class="dados-nome-titulo upper" id="modalInfoEscolhido"></span>
                        <span class="dados-dinheiro" id="modalInfo"></span> 
                    </div>
                    <div class="divsPopup upper" id="infosGerais">
                        <span>Informações gerais</span>
                    </div>
                    <div id="overlay">
                        <div class="container">
                            <div class="spinner"></div>
                            <span class="loadtext">loading</span>
                            
                        </div>
                    </div> 
                    <div class="parte-tabela divsPopup">
                            <div class="modal-dadosgerais" id="divtotal">
                                        
                                    <div class="modal-dados1">
                                        <div>
                                        <span class="dados-nome">HABITANTES</span>
                                        
                                        </div>
                                        <div id='bonecosPopulacao'>
                                       
                                        </div> 
                                        
                                    </div>
                                    
                                    <div>
                                        <div class="modal-dados2">
                                            <div style="position: absolute; top:0.7rem;">
                                                <i class="fa fa-usd icones" aria-hidden="true" style="
                                                font-size: 70px;
                                                line-height: 40px;"></i> 
                                            </div>
                                            <div style="position: absolute; left: 3.5rem; top: 0.4rem;">   
                                                    <span class="dados-nome" style="line-height:1rem;">PIB<br />
                                                        <span class="dados-dinheiro" id="PIB"></span></span>
                                                        <br />     
                                                                                                       
                                            </div>
                                        </div>
                        
                                        <div class="modal-dados3">                                                
                                            <div style="width: 7rem; height:7rem; position: absolute; left:1rem;">
                                                <i class="fa fa-user icones" aria-hidden="true" style="
                                                font-size: 80px;
                                                line-height: 65px;"></i>
                                                
                                                    <i class="fa fa-usd icones" aria-hidden="true" style="
                                                    font-size: 30px;
                                                    line-height: 10px;
                                                    left: 3.5rem;
                                                    position:absolute;
                                                    "></i> 
                                                
                                            </div>
                                            <div style="position: absolute; left: 7.5rem; top: 0.5rem;">
                                                    <span class="dados-nome" style="line-height:1rem;">PIB per capita<br />
                                                        <span class="dados-dinheiro" id="PIBperCapita" style="top: 2rem;"></span>
                                                        </span><br />
                                             </div>
                                        </div>
                                        
                                        
                                        <div class="modal-dados4">
                                            <div>
                                                <span class="upper" id="dados-rendimentoMedio" >Rendimento Médio</br></span>
                                            </div>
                                            
                                            
                                            <div style="display: inline-block;">
                                                <i class="fa fa-female iconePessoa" aria-hidden="true"></i>
                                            <span class="dados-dinheiro" id="Médiarendimentomulheres"></span>
                                            </div>
                                            <div style="display: inline-block;">
                                                <i class="fa fa-male iconePessoa" aria-hidden="true"></i>
                                                <span class="dados-dinheiro" id="Médiarendimentohomens"></span>
                                            </div>
                                            

                                            
                                            
                                        </div>
                                        
                                        <div class="modal-dados5" >
                                                
                                            <div id="chartContainer"  ></div>
                                            <div id="infosPieChart" class='dados-nome'>
                                            </div>
                                        </div>
                                        
                                    </div>            
                                    
                                    
                                       
                                </div>      

                        <ul class="tabs" role="tablist" style="display: none;">
                            <!-- Primeira aba, Histórico
                            Método voltarSetaInicial -> classes/Abas.js 
                            Método drawLineChart -> classes/BarChart.js 
                            -->
                            <li>
                                <input type="radio" name="tabs" id="tab1" onclick="voltarSetaInicial(); drawLineChart();"/>    
                                <label for="tab1" 
                                    role="tab" 
                                    class="tabs-label1"
                                    aria-selected="true" 
                                    aria-controls="panel1" 
                                    tabindex="0">Ver histórico</label>
                                <div id="tab-content1" 
                                    class="tabs-content" 
                                    role="tabpanel" 
                                    aria-labelledby="description" 
                                    aria-hidden="false">
                                    <div>
                                        <div id="linechart_values" ></div>
                                    </div>
                                    
                                </div>
                            </li>
                            <!-- Segunda aba, Gráfico
                            Método voltarSetaInicial -> classes/Abas.js 
                            Método drawBarChart -> classes/BarChart.js 
                            -->
                            <li>
                                <input type="radio" name="tabs" id="tab2" onclick="voltarSetaInicial(); drawBarChart('columnchart_values');"/>
                                <label for="tab2"
                                    class="tabs-label2"  
                                    role="tab" 
                                    aria-selected="false" 
                                    aria-controls="panel2" 
                                    tabindex="0">Ver gráfico</label>
                                <div id="tab-content2" 
                                    class="tabs-content"
                                    role="tabpanel" 
                                    aria-labelledby="specification" 
                                    aria-hidden="true">
                                    <div>
                                        <i id="columnchart_values"></i>
                                    </div>
                                    
                                </div>
                            </li>
                            <!-- Terceira aba, Dados gerais
                            Método voltarSetaInicial -> classes/Abas.js 
                            -->
                            <li>
                                <input type="radio" name="tabs" id="tab3" checked onclick="voltarSetaInicial();"/>
                                <label for="tab3"
                                    class="tabs-label3"
                                    role="tab" 
                                    aria-selected="false" 
                                    aria-controls="panel3" 
                                    tabindex="0">Ver dados gerais</label>
                                <div id="tab-content3" 
                                    class="tabs-content"
                                    role="tabpanel" 
                                    aria-labelledby="specification" 
                                    aria-hidden="false">
                                    
                                               
                                    <div class="modal-dadosgerais" id="divtotal">
                                        
                                        <div class="modal-dados1">
                                            <div style="position: absolute">
                                                <span class="dados-nome" id="modalEstadoUF"></span>
                                                
                                            </div>
                                            <div style="position: absolute; left:5rem; top: 0.4rem;">
                                                <span class="dados-nome" style="font-size: 18px;line-height: 21px;">HABITANTES<br /></span>
                                                <span id="Populaçãototal"></span><br />
                                            </div>
                                            <div id='bonecosPopulacao'>

                                            </div>
                                        </div>
                                        
                                        <div>
                                            <div class="modal-dados2">
                                                <div style="position: absolute; top:0.7rem;">
                                                    <i class="fa fa-usd icones" aria-hidden="true" style="
                                                    font-size: 70px;
                                                    line-height: 40px;"></i> 
                                                </div>
                                                <div style="position: absolute; left: 3.5rem; top: 0.4rem;">   
                                                        <span class="dados-nome" style="line-height:1rem;">PIB<br />
                                                            <span class="dados-dinheiro" id="PIB" style="top: 1.8rem;"></span></span>
                                                            <br />     
                                                                                                           
                                                </div>
                                            </div>
                            
                                            <div class="modal-dados3">                                                
                                                <div style="width: 7rem; height:7rem; position: absolute; left:1rem;">
                                                    <i class="fa fa-user icones" aria-hidden="true" style="
                                                    font-size: 80px;
                                                    line-height: 65px;"></i>
                                                    
                                                        <i class="fa fa-usd icones" aria-hidden="true" style="
                                                        font-size: 30px;
                                                        line-height: 10px;
                                                        left: 3.5rem;
                                                        position:absolute;
                                                        "></i> 
                                                    
                                                </div>
                                                <div style="position: absolute; left: 7.5rem; top: 0.5rem;">
                                                        <span class="dados-nome" style="line-height:1rem;">PIB per capita<br />
                                                            <span class="dados-dinheiro" id="PIBperCapita" style="top: 2rem;"></span>
                                                            </span><br />
                                                 </div>
                                            </div>
                                            
                                            
                                            <div class="modal-dados4">
                                                <span class="dados-nome" style="font-size: 20px;
                                                line-height: 23px;
                                                letter-spacing: 0.1em;">Rendimento<br /><span id="modalRendimentoValor"></span></span>
                                                <p class="dados-nome" style="font-size: 14px;
                                                line-height: 16px;">MÉDIO<br /></p>

                                                <i class="fa fa-female iconePessoa" aria-hidden="true" style="
                                                right: -2rem;
                                                top: -2rem;
                                                "></i>
                                                <i class="fa fa-male iconePessoa" aria-hidden="true" style="
                                                left: 10rem;
                                                top: -2rem;
                                                "></i>

                                                <span class="dados-dinheiro" id="Médiarendimentohomens"></span><br />
                                                <span class="dados-dinheiro" id="Médiarendimentomulheres"></span><br />
                                            </div>
                                            
                                            <div class="modal-dados5" >
                                                    
                                                <div id="chartContainer"  ></div>
                                                <div id="infosPieChart" class='dados-nome'>
                                                </div>
                                            </div>
                
                                        </div>            
                                        
                                        <!-- <p id="link-fonte"><a id='link-popup'>Fonte: NA</a></p> -->
                                           
                                    </div>      
                            </li>
                            <!-- Quarta "aba", Icone de abrir/fechar abas
                            Método fechaAba -> classes/Abas.js 
                            -->
                            <li>
                                <input type="radio" name="tabs" id="tab4" onclick="fechaAba();"/>
                                <label for="tab4"
                                    class="tabs-label4"  
                                    role="tab" 
                                    aria-selected="false" 
                                    aria-controls="panel4" 
                                    tabindex="0"
                                    id="iconUp"><i id="seta" class="fa fa-sort-asc" aria-hidden="true"></i></label>
                                <div id="tab-content4" 
                                    class="tabs-content"
                                    role="tabpanel" 
                                    aria-labelledby="specification" 
                                    aria-hidden="true">
                                  
                                </div>
                            </li>
                            
                        </ul>

                       
                    </div>
                      

                </div>
            </div>

        </div>
    </div>

    <!-- scripts adicionados -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <!--  -->
    <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <script>

//const host = "http://localhost:3000";
const host = "http://teste.visao.ibict.br";
var apiKey = window.sessionStorage.getItem('jhi-authenticationtoken');
if(apiKey){
apiKey = apiKey.substring(1, apiKey.length - 1);
}
//console.log(apiKey);

// Iniciar mapa objeto sem zoom, latitude, longitude, zoom inicial
var map = L.map('map', {
        zoomControl:false,
        doubleClickZoom: false
    }).setView([-15, -50], 4);
// map.setMaxBounds(map.getBounds());

var cookies = document.cookie.split(';');
var existeCookie = false;
cookies.forEach(function (cookie) {
    if(cookie === " logged=true"){
        $('.show-logado').show();
        $('.show-deslogado').hide();
        existeCookie = true;
    }
});
if(!existeCookie) {
    $('.show-logado').hide();
    $('.show-deslogado').show();
}

var baseLayers = {
    'Gao De Image': L.layerGroup([L.tileLayer('http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}', {
        subdomains: "1234"
    }), L.tileLayer('http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png', {
        subdomains: "1234"
    })]),
    "Mapa tridimensional": L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        id: 'mapbox.satellite'
    }),
    'GeoQ': L.tileLayer('http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}'),
    "Mapa escuro": L.layerGroup([L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png', {
        subdomains: "1234"
    }), L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_only_labels/{z}/{x}/{y}.png', {
        subdomains: "1234"
    })]),
    "Mapa claro": L.layerGroup([L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {
        subdomains: "1234"
    }), L.tileLayer('http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png', {
        subdomains: "1234"
    })])
    .addTo(map)
};

var layercontrol = L.control.layers(baseLayers,{}, {
    position: "topleft"
}).addTo(map);

markers = L.markerClusterGroup({ chunkedLoading: true });

var group = new L.FeatureGroup();

var arrayCompleto, municipioArray, estadoArray;
var indicatorArray, filterArray, years;
var estado, mesoRegiao, municipio;
var maxValue, minValue, midValue, categories, indicatorNames, groupLayer;
var indicadorMapControl, filtroMapControl, limparMapControl, rangeBarControl, mapControl, botao2, botao3;
var filtrosId, layersId;
var indicadorSelecionado;
var filtrosPesquisados = new Map();
var indicadorAtual;
var istance;
var anoId=0;
var minColor='#d4e76e',midColor='#66baae',maxColor='#a64cdf';
var gradientesIniciais= 'linear-gradient(to right, #d4e76e, #b9e17b, #9dda88 ,  #83d494 , #6acda0,#66baae,  #789abc ,   #897cca,  #9764d5 , #a64cdf )';
var pflag=0
var flagPopfaixa=false
var gradiente1='';
var gradiente2='';
var gradiente3='border: 2px solid #146678;';


getGeoJson();
$(".leaflet-right.leaflet-bottom").css('right', '340px');

//Muda a barra de cores 
function styleMapFunc(valor){
    switch (valor) {
      case '2':
        // $('.range-bar').css('background-image', 'linear-gradient(to right, #F19C44, #EF8153, #EE6C60, #EC556D, #D94D74, #C8477A, #B2407D, #9E2D5E, #87193C, #6F0417)');
        minColor='#F19C44';
        midColor='#D94D74';
        maxColor='#6F0417';
        gradiente1='border: 2px solid #146678;';
        gradiente2='';
        gradiente3='';
        break;
      case '3':
        // $('.range-bar').css('background-image', 'linear-gradient(to right, #e66361, #e37945, #d2922f, #b6ab2d, #90c047)');
        maxColor='#e66361';
        midColor='#d2922f';
        minColor='#90c047';
        gradiente1='';
        gradiente2='border: 2px solid #146678;';
        gradiente3='';
        break;
      default:
        // $('.range-bar').css('background-image', 'linear-gradient(to right, #a64cdf, #9764d5, #897cca, #789abc, #66baae, #6acda0, #83d494, #9dda88, #b9e17b, #d4e76e)');
        minColor='#d4e76e';
        midColor='#66baae';
        maxColor='#a64cdf';
        gradiente1='';
        gradiente2='';
        gradiente3='border: 2px solid #146678;';

    }
}

//abre a lista de opcoes de gradiente
function abrirListaGrad(trigger,cName) {
    // var trigger = $('.gradient_selector');
    console.log(trigger);
    var list_grad = $('.'+cName);
    list_grad.show();
    trigger.blur(function(){
        list_grad.hide();
    });
};


//Muda a cor da opção do gradiente
function changeColorFunc(select){
    //select.style.backgroundImage=document.getElementById('opcaoGradiente1').style;
    
    //$('.gradient_selector').css('background-image',);
    gradientesIniciais=select.style.backgroundImage;

}

//Funções adicionados
function fechaAba(){
    /*  
    Método utilizado para substituir o ícone de fechar/abrir as abas da janela pop-up.
    Ao abrir as abas, a default será a aba ver dados gerais.
        
    */
    var icon=document.getElementById("iconUp");
    var seta=document.getElementById("seta");

    icon.style="color: #146678; background-color:#F2F2F2; line-height: 18px;";

    if(seta.className.match("fa fa-sort-asc")){
        $("#iconUp").html("<i id='seta' class='fa fa-sort-desc' aria-hidden='true'></i>");

    }else{
        $("#iconUp").html("<i id='seta' class='fa fa-sort-asc' aria-hidden='true'></i>");
        document.getElementById("tab3").click();
    }
    
}

function voltarSetaInicial(){
    /*
    Método para alterar o ícone de fechar/abrir abas caso alguma aba seja aberta diretamente pelo próprio ícone.
    */
    $("#iconUp").html("<i id='seta' class='fa fa-sort-asc' aria-hidden='true'></i>");

    


}

function showops(idSeta,idTexto){
    var seta=document.getElementById(idSeta);
    if(seta.className.match("fa fa-sort-asc arrowCss")){
        seta.className="fa fa-sort-desc arrowCss";
        seta.style.top='0rem';
        $('#'+idTexto).hide();
    }else{
        
        seta.className="fa fa-sort-asc arrowCss";
        $('#'+idTexto).show();
        seta.style.top='0.5rem';
    }
}

/*
drawBarChart:
    Método para construir o gráfico de barras.
        Variávies:
            data: Array com os dados do gráfico. A última coluna representa a cor da barra.
            options: "Style"/"Css" do gráfico de barras. 

drawLineChart:
    Método para construir o gráfico de linha.
        Variávies:
            data: Array com os dados do gráfico. A última coluna representa a cor dos pontos no gráfico.
            options: "Style"/"Css" do gráfico de barras. 



*/
var irvoltar;

function drawBarChart(id) {

    var data = google.visualization.arrayToDataTable([
    ["Estado e Brasil","Pib per capta",{ role: "style" } ],
    ["Amazonas", 22000, "#146678"],
    ["Brasil", 28000, "#E5C75A"]
    
    ]);

    var options = {

    backgroundColor:"#F2F2F2",
    width: 655,
    height: 400,
    bar: {groupWidth: "40%"},
    legend: { position: "none" },
    "vAxis":{
        
        'title': 'Pib per capta',
        ticks: [10000,20000,30000,40000],
        viewWindow:{max:40000}
        
    },
    'hAxis':{
        title:"Estado e Brasil",
    }
    };
    var chart = new google.visualization.ColumnChart(document.getElementById(id));
    chart.draw(data, options);
}



function drawLineChart() {
    var dados = google.visualization.arrayToDataTable([
    ["Ano", "Pib per Capta",{'type': 'string', 'role': 'style'} ],                          
    ['2006',  17000,'point { size: 3; fill-color: #E6C75A; }'],
    ['2007',  17830,'point { size: 3; fill-color: #E6C75A; }'],
    ['2008',  18000,'point { size: 3; fill-color: #E6C75A; }'],
    ['2009',  18170,'point { size: 3; fill-color: #E6C75A; }'],
    ['2010',  19000,'point { size: 3; fill-color: #E6C75A; }'],
    ['2011',  19170,'point { size: 3; fill-color: #E6C75A; }'],
    ['2012',  20000,'point { size: 3; fill-color: #E6C75A; }'],
    ['2013',  21170,'point { size: 3; fill-color: #E6C75A; }'],
    ['2014',  21000,'point { size: 3; fill-color: #E6C75A; }'],
    ['2015',  23170,'point { size: 3; fill-color: #E6C75A; }']
    ]);

    var opcoes = {

    backgroundColor:"#F2F2F2",
        
    width: 700,
    height: 400,
    pointSize: 7,
    minorGridlines: { count: 1 },
    legend: { position: "none" },
    "vAxis":{
        textStyle:{ italic:true },
        'title': 'Pib per capta',
        'ticks': [10000,20000,30000,40000],
        
    },
    'hAxis':{
        title:"Ano"   
    }
    };
    var chart = new google.visualization.LineChart(document.getElementById("linechart_values"));
    chart.draw(dados, opcoes);
}

function mostrargraf(restart=false){
    
    if(irvoltar || restart){
        $('#divGrafInfoInd').html('Ver gráfico');
        $("#divTextoInfoInd").show();
        $("#columnchart_values2").hide();
        irvoltar=false;
        
    }else{
        
        $("#divTextoInfoInd").hide();
        $("#columnchart_values2").show();
        $('#divGrafInfoInd').html('Voltar');
        irvoltar=true;
    }

    

}

    /*
        Modal Chart Class
            Class utilizada para incluir um gráfico com os seus devidos labels.

        Construtor
            ModalChart(animationEnabled, chartType, startAngle, indexLabelFontSize, indexLabel, toolTipContent, dataPoints)

            Exemplo:

                var mychart = new ModalChart(
                false, "doughnut",　270, 
                17, "", 
                "", 
                [
                    { y: 2, label: "Superior Completo" },
                    { y: 98, label: "Outro" },
                ]);

        Atributos
            animationEnabled: boolean
            data:
                chartType: String
                startAngle: Integer
                indexLabelFontSize: Integer
                indexLabel:  String;
                toolTipContent: String;
                dataPoints: Array[{y: Integer, label: String}];

        Métodos:
            createPieChart(chartId, labelId)
                Esse método cria o gráfico escolhido no chartId, e os labels dos dados no labelId.
                Caso o nome do label seja Outro então não será criada uma label para ele.
                Exemplo:
                    createPieChart(modalDiv, labelDiv);
                    // Cria o chart na div modalDiv e põe os respectivos labels na labelDiv

        Dúvidas?
            Consultar Danilo ou Reinaldo
    
    */

    function ModalChart(animationEnabled, chartType, startAngle, indexLabelFontSize, indexLabel, toolTipContent, dataPoints){
        this.data = new Object();
        this.createPieChart = createPieChart;

        this.animationEnabled = animationEnabled;
        this.data.chartType = chartType;
        this.data.startAngle = startAngle;
        this.data.indexLabelFontSize = indexLabelFontSize;
        this.data.indexLabel =  indexLabel;
        this.data.toolTipContent = toolTipContent;
        this.data.dataPoints = dataPoints;
    }

    function createPieChart(chartId,labelId){
        $("#"+labelId).html('');
        var chart = new CanvasJS.Chart(chartId, {
        animationEnabled: this.animationEnabled, 
        backgroundColor: "#F2F2F2", 
        data: [{
        indexLabelFormatter: function(e){
                if(e.dataPoint.label!="Outro"){
                    $("#"+labelId).append("<span >"+e.dataPoint.label　+ "　"　+ e.percent.toFixed(2) + "%"+ "</span><br />");
                }                            
                return "" ;},
            
            type: this.data.chartType,
            startAngle: this.data.startAngle,
            indexLabelFontSize: this.data.indexLabelFontSize,
            indexLabel: this.data.indexLabel,
            toolTipContent: this.data.toolTipContent,
            dataPoints: this.data.dataPoints
        }]
        });
        chart.render();
    }






// função abrirAbaFiltro para dados do filtro selecionado
function abrirAbaFiltro(dado){
    $('#descricaoDoIndicador').html('');
    $.ajax({
            headers: {
                "Authorization": "Bearer " + apiKey
            },
            url: 'http://teste.visao.ibict.br/api/grup-indicators/'+indicadorAtual,

        dataType: 'json',
            async: false,
            success: function (data) {
            
            $('#descricaoDoIndicador').html(data.description.replace('\\n', "<br>"));
                        }
                    });

    $('#aba-filtro-selecionado').modal('show');
    
    $('#info-selecionado').html(dado);
    setMulEntries();
    
    $.ajax({
        headers: {
            "Authorization": "Bearer " + apiKey
        },
        url: 'http://teste.visao.ibict.br/api/grup-indicators/'+indicadorAtual,

    dataType: 'json',
        async: false,
        success: function (data3) {
            
            var link=data3.source.split('##');
            
            //console.log(linkPrep)
           
            document.getElementById("link-popup").target="_blank";
            if (link.length>1){ 
                document.getElementById("link-popup").href=link[0];
                $('#link-popup').html("Fonte: "+link[1]);
                
            }else{
                var linkPrep=data3.source.split(' ');
                link=linkPrep[linkPrep.length - 1];
                document.getElementById("link-popup").href=link;
                if (link.length>30){
                    link=link.slice(0,50)+'...';
                    $('#link-popup').html("Fonte: "+link);
                }else{
                    $('#link-popup').html("Fonte: "+link);
                }
            } 
            //if (link.length>10){
            //    link=link.slice(0,50)+'...';
            //    $('#link-popup').html("Fonte: "+link);
            //}else{
            //    $('#link-popup').html("Fonte: "+link);
            //}
            
            }
    });


}
//*****************************************************************
// função para mostrar o link da fonte
function abrirAbaFiltro2(data3,indicadorId){
    
    
    var link=data3.split('##');
    
    //console.log(linkPrep)
    
    document.getElementById("link-popup2").target="_blank";
    if (link.length>1){ 
        document.getElementById("link-popup2").href=link[0];
        $('#link-popup2').html("Fonte: "+link[1]);
        
    }else{
        var linkPrep=data3.split(' ');
        link=linkPrep[linkPrep.length - 1];
        document.getElementById("link-popup2").href=link;
        if (link.length>30){
            link=link.slice(0,50)+'...';
            $('#link-popup2').html("Fonte: "+link);
        }else{
            $('#link-popup2').html("Fonte: "+link);
        }
    } 
    //if (link.length>10){
    //    link=link.slice(0,50)+'...';
    //    $('#link-popup2').html("Fonte: "+link);
    //}else{
    //    $('#link-popup2').html("Fonte: "+link);
    //}



    categories.filter(function (categoria) {
                return categoria.type === 'INDICATOR';
            }).forEach(function(item) {
                if (item['grup-indicators'].find(element => element.id == indicadorId)!=undefined){
                    $('#Indicador-popup').html(item.name);
                    return
                }
            });

            
}




// Função para adicionar as infos dos itens selecionados
function setMulEntries(){
    $('#multipleEntries').html('');
    var i=0;
    var texto;
    filtrosId.forEach(function (filtro) {

        $.ajax({
            headers: {
                "Authorization": "Bearer " + apiKey
            },
            url: "http://teste.visao.ibict.br/api/geographic-filters/"+filtro,

        dataType: 'json',
            async: false,
            success: function (data) {
                if (data.description){
                    texto=data.description;
                }else{
                    texto='Descrição não atualizada.';
                }
                $('#multipleEntries').append('<div style="width:max-content; padding-top: 1rem;" onclick="showops(\'seta'+i+'\',\'textoParaShow'+i+'\');">'+
                '<div class="entryDiv1">'+
                '<span class="dados-nome-titulo" style=" margin: 1rem;"> '+data.name+'</span>'+
                '<i  class="fa fa-sort-desc arrowCss" aria-hidden="true"'+
                "id='seta"+i+"'></i>"+
                '</div>'+
            ' </div> '+
            '<div>'+
                '<div>'+
                    '<p class="info-sobre-ind" id="textoParaShow'+i+'"  style="text-align: justify; display: none;">'+
                    texto+
                    '</p>'+

                '</div>'+
                
            '</div>');
            }
        });
        i=i+1;
            
    });

}

//Função para adicionar icones de acordo com a população
function addBonecos(){
    var i;
    $('#bonecosPopulacao').html('');
    for (i=0;i<3;i++){
        $('#bonecosPopulacao').append('<i class="fa fa-user-o bonecosPop"'+
        'aria-hidden="true"></i>');
    }
    $('#bonecosPopulacao').append('<span id="Populaçãototal"></span>');
}
function popupStart(data){
    $('#overlay').show();
    $('#exampleModal').modal('show');
    $(".parte-tabela").hide();
    $("#infosGerais").hide();
    $('#modalEstado').html($('#box_'+data).html());
    $('#modalInfoEscolhido').html($('#both').html());
    $('#modalInfo').html($('#dado-escolhido-popup').html());
    //myFunction(data);
    myVar = setTimeout(myFunction(data), 500);
}

function myFunction(data) {
    
    // Deve ser passado como parametro se deve ou não ser criado um gráfico.
    
    console.log(data);
    
    var geoId;
    ChartExists=false;
    document.getElementById("tab3").click();
    // var link="https://google.com";
    
    addBonecos();
    $('#Populaçãototal').html("Não Consta");
    $('#modalEstadoUF').html("Não Consta");
    $('#PIB').html("Não Consta");
    $('#PIBperCapita').html("Não Consta");
    $('#Médiarendimentomulheres').html("Não Consta");
    $('#Médiarendimentohomens').html("Não Consta");
    $('#modalSuperiorCompletoValor').html("%2.5");
    
    
    

    var listaDosInd=[1,2,39,55,27,28]
    var nomeDosInd=['#PIB','#PIBperCapita','modalSuperiorCompletoValor','#Populaçãototal','#Médiarendimentohomens','#Médiarendimentomulheres'];
    
    $.ajax({
        headers: {
            "Authorization": "Bearer " + apiKey
        },
        url: 'http://teste.visao.ibict.br/api/regions?geoCode.equals='+data,

        dataType: 'json',
        async: false,
        success: function (data1) {
            console.log(data1);
            $('#modalEstadoUF').html(data1[0].uf);
            geoId=data1[0].id;
        }
    });
    for(i=0;i<6;i++){
        $.ajax({
        headers: {
            "Authorization": "Bearer " + apiKey
        },
        url: 'http://teste.visao.ibict.br/api/yearsDistinct?groupId.equals='+listaDosInd[i],
        
        dataType: 'json',
        async: false,
        success: function (dados1) {
            $.ajax({
            headers: {
                "Authorization": "Bearer " + apiKey
            },
            url: 'http://teste.visao.ibict.br/api/indicators?groupId.equals='+listaDosInd[i]+'&regionId.equals='+geoId+'&yearId.equals='+dados1[0].id,

            dataType: 'json',
            async: false,
            success: function (dados2) {
                
                
                $(nomeDosInd[i]).html(dados2[0].value+'(dados de '+dados1[0].date.slice(0,4)+')');
                
            
                }   
            });
        }
    });
    }


    $.ajax({
            headers: {
                "Authorization": "Bearer " + apiKey
            },
            url: 'http://teste.visao.ibict.br/api/indicators?groupId.in=1&groupId.in=2&groupId.in=39&groupId.in=55&groupId.in=27&groupId.in=28&regionId.equals='+geoId+'&yearId.equals='+anoId,

            dataType: 'json',
            async: false,
            success: function (data2) {
                console.log(data2);
                data2.forEach(function (filtro) {
                $('#'+filtro.group.name.replace(/ /g,'')).html(filtro.value);
                
                })
                modalDetail();
                }   
            });
     
    // console.log(years);
    // if(ChartExists) {
    //     var mychart = new ModalChart(
    //     false, "doughnut",　270, 
    //     17, "", 
    //     "", 
    //     [
    //         { y: 2, label: "Superior Completo" },
    //          { y: 98, label: "Outro" },
    //     ]);
        
    //     mychart.createPieChart("chartContainer","infosPieChart");
                
    // }
   
    modalDetail();
}


// função modalDetail alterado para dados apresentados na tela pop-up
google.charts.load("current", {'packages':['corechart']});
function modalDetail(data){
    
    $('#overlay').hide();
    $(".parte-tabela").show();
    $("#infosGerais").show();
    
}






function getUrlParameter(sParam) {
    var sPageURL = window.location.search.substring(1),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
    }
};


function getGeoJson(){
    //usage in request
    
    //console.log(getUrlParameter('grupCategory'));
    /*
    $.ajax({
        url: host+'/api/grup-categories/'+getUrlParameter('grupCategory'),
        dataType: 'json',
        success: function(data) {
            console.log(data);
        }
    });
    */
    
    //http://teste.visao.ibict.br/api/categories?id.in=1&id.in=2&id.in=3&id.in=4
    /*

    var already_loaded = new Object();  // used to track which accordions have already been loaded

$(function() {
    $( "#accordion" ).accordion({
        collapsible: true,
        active: false,
        //heightStyle: 'fill', // http://jqueryui.com/accordion/#fillspace  -- Just sets the height of the accordion to the height of it's parent container.  We need a way to change the height of the parent to that of the newly added content.
        activate: function (e, ui) {
            // only fire when the accordion is opening..
            if(ui.newHeader.length>0){                
                // only retrieve the remote content once..
                if(! already_loaded[ui.newHeader[0].id]==1){
                    var srcObj = $(ui.newHeader[0]).children('a');
                    var url = srcObj.attr('href');
                    var folder = srcObj.attr('data-folder');
                    //$.get(url, function (data){  // if you wanted to use the GET method uncomment this and comment the next line.  Be sure to add any needed query string parameters to the URL.
                    $.post(url, {doCmd:'getFolderFiles', folder:srcObj.attr('data-folder')}, function (data){
                        $(ui.newHeader[0]).next().html(data);
                        var contentDiv = $(ui.newHeader[0]).next()[0];
                        $('#'+contentDiv.id).height(contentDiv.scrollHeight);
                        //$("#accordion").accordion("refresh"); // http://api.jqueryui.com/accordion/#method-refresh -- The documentation isn't clear on this but this only refreshes added/removed panels.  Does not refresh existing panels with newly added content.
                        already_loaded[ui.newHeader[0].id]=1; // keep track of the loaded accordions
                    });
                }
            }
        }

    });

});
    
    
    */
    $.ajax({
        url: host+'/map/pais.json',
        dataType: 'json',
        success: function(data1) {
            
            pais = data1;
            pflag=1;
        },
        error: function (error) {
            pflag='error'
        }
    });
    $.ajax({
        url: host+'/map/municipio.json',
        dataType: 'json',
        success: function(data) {
            municipio = data;
            
        }
    });
    
    $.ajax({
        url: host+'/api/grup-categories/'+getUrlParameter('grupCategory'),
        dataType: 'json',
        
        
        success: function(data) {
            istance = data;
            categories = istance.categories;
            //var urlIndicator = '';
            //console.log(categories);
            
            categories.filter(function (categoria) {
                return categoria.type === 'INDICATOR';
            }).forEach(function(item) {
                $.ajax({
                    headers: {
                        "Authorization": "Bearer " + apiKey
                    },
                    url: host+'/api/grup-indicators?categoryId.equals='+item.id,
                    dataType: 'json',
                    success: function(data) {
                        indicatorNames = data;
                        //console.log(data);
                        item['grup-indicators'] = data;
                    }
                });
            });
            categories.filter(function (categoria) {
                return categoria.type === 'FILTER';
            }).forEach(function(item) {
                $.ajax({
                    headers: {
                        "Authorization": "Bearer " + apiKey
                    },
                    url: host+'/api/geographic-filters?categoryId.equals='+item.id,
                    dataType: 'json',
                    success: function(data) {
                        indicatorNames = data;
                        //console.log(data);
                        item['geographic-filters'] = data;
                    }
                });
            });
            let flag1=0
            categories.filter(function (categoria) {
                return categoria.type === 'LAYER';
            }).forEach(function(item) {
                $.ajax({
                    headers: {
                        "Authorization": "Bearer " + apiKey
                    },
                    url: host+'/api/group-layers?categoryId.equals='+item.id,
                    dataType: 'json',
                    success: function(data) {
                        indicatorNames = data;
                        //console.log(data);
                        item['group-layers'] = data;
                        $.ajax({
                            url: host+'/map/estado.json',
                            dataType: 'json',
                            success: function(data) {
                                estado = data;
                                if (flag1==0){
                                    makeMap();
                                    flag1=1;
                                }
                            }
                        });
                    }
                });
            });
            
            console.log(categories);
            //urlIndicator = urlIndicator.replace('&','?');
            //console.log(urlIndicator);
            
        }
    });
    
}

function genereteListIndicators(){
    var indicatorCategory = '';
    var arrayOrdemLvl = [];
    for(i=0; i<categories.length; i++){
        arrayOrdemLvl.push('');
    }
    categories.filter(function (categoria) {
        return categoria.type === 'INDICATOR';
    }).forEach(function(item) {


        if (item.level==null){
            indicatorCategory +=    '                   <div style="border-bottom: 1px solid #E0E0E0;" class="card">' +
                                    '                       <div style="border: 0;" class="card-header" id="headingCard'+ item.id +'">' +
                                    '                           <h5 class="mb-0">' +
                                    '                               <button style="background-color: #fff;" class="btn btn-link" data-toggle="collapse" data-target="#collapse'+ item.id  +'" aria-expanded="true" aria-controls="collapseOne">' +
                                    '                                   <div class="robotoFamily " style="display: inline-block; text-overflow: ellipsis; overflow: hidden; width: 200px; height: 20px; white-space: nowrap;" title="'+ item.name +'">'+ item.name +' </div><i class="pull-right fa fa-angle-right" aria-hidden="true"></i>' +
                                    '                               </button>' +
                                    '                           </h5>' +
                                    '                       </div>' +
                                    '                       <div id="collapse'+ item.id  +'" class="collapse" aria-labelledby="headingCard'+ item.id +'" data-parent="#accordion">' +
                                    '                           <div class="card-body">';
            if(item.name=="População por faixa etária"){
                var arrayOrdemFaixa=[];
                for(i=0; i<item['grup-indicators'].length; i++){
                    arrayOrdemFaixa.push('');
                }
                item['grup-indicators'].forEach(function(indicator) {
                indiceFaixa=indicator.name.split(' ')[0].split('-')[0]/5
                arrayOrdemFaixa[indiceFaixa] +=    '                               <div class="form-check">' +
                                        '                                   <div class="custom-control custom-radio">' +
                                        '                                       <input type="radio" id="indicador'+ indicator.id +'" name="indicator" class="custom-control-input form-check-input" value="'+indicator.id+'">' +
                                        '                                       <label class="custom-control-label form-check-label robotoFamily" for="indicador'+ indicator.id +'">'+ indicator.name +'</label>' +
                                        '                                   </div>' +
                                        '                               </div>';
                    
                });
                for(i=0; i<item['grup-indicators'].length; i++){
                    indicatorCategory+=arrayOrdemFaixa[i];
                }
            }else{
                item['grup-indicators'].forEach(function(indicator) {
                    
                    indicatorCategory +=    '                               <div class="form-check">' +
                                            '                                   <div class="custom-control custom-radio">' +
                                            '                                       <input type="radio" id="indicador'+ indicator.id +'" name="indicator" class="custom-control-input form-check-input" value="'+indicator.id+'">' +
                                            '                                       <label class="custom-control-label form-check-label robotoFamily" for="indicador'+ indicator.id +'">'+ indicator.name +'</label>' +
                                            '                                   </div>' +
                                            '                               </div>';
                    
                });
            }
            indicatorCategory +=    '                           </div>' +
                                    '                       </div>' +
                                    '                   </div>';
        }else{
            arrayOrdemLvl[item.level] +=    '                   <div style="border-bottom: 1px solid #E0E0E0;" class="card">' +
                                    '                       <div style="border: 0;" class="card-header" id="headingCard'+ item.id +'">' +
                                    '                           <h5 class="mb-0">' +
                                    '                               <button style="background-color: #fff;" class="btn btn-link" data-toggle="collapse" data-target="#collapse'+ item.id  +'" aria-expanded="true" aria-controls="collapseOne">' +
                                    '                                   <div class="robotoFamily " style="display: inline-block; text-overflow: ellipsis; overflow: hidden; width: 200px; height: 20px; white-space: nowrap;" title="'+ item.name +'">'+ item.name +' </div><i class="pull-right fa fa-angle-right" aria-hidden="true"></i>' +
                                    '                               </button>' +
                                    '                           </h5>' +
                                    '                       </div>' +
                                    '                       <div id="collapse'+ item.id  +'" class="collapse" aria-labelledby="headingCard'+ item.id +'" data-parent="#accordion">' +
                                    '                           <div class="card-body">';

            if(item.name=="População por faixa etária"){
                var arrayOrdemFaixa=[];
                for(i=0; i<item['grup-indicators'].length; i++){
                    arrayOrdemFaixa.push('');
                }
                item['grup-indicators'].forEach(function(indicator) {
                indiceFaixa=indicator.name.split(' ')[0].split('-')[0]/5
                arrayOrdemFaixa[indiceFaixa] +=    '                               <div class="form-check">' +
                                        '                                   <div class="custom-control custom-radio">' +
                                        '                                       <input type="radio" id="indicador'+ indicator.id +'" name="indicator" class="custom-control-input form-check-input" value="'+indicator.id+'">' +
                                        '                                       <label class="custom-control-label form-check-label robotoFamily" for="indicador'+ indicator.id +'">'+ indicator.name +'</label>' +
                                        '                                   </div>' +
                                        '                               </div>';
                    
                });
                for(i=0; i<item['grup-indicators'].length; i++){
                    arrayOrdemLvl[item.level]+=arrayOrdemFaixa[i];
                }
            }else{
                item['grup-indicators'].forEach(function(indicator) {
                    
                    arrayOrdemLvl[item.level] +=    '                               <div class="form-check">' +
                                            '                                   <div class="custom-control custom-radio">' +
                                            '                                       <input type="radio" id="indicador'+ indicator.id +'" name="indicator" class="custom-control-input form-check-input" value="'+indicator.id+'">' +
                                            '                                       <label class="custom-control-label form-check-label robotoFamily" for="indicador'+ indicator.id +'">'+ indicator.name +'</label>' +
                                            '                                   </div>' +
                                            '                               </div>';
                    
                });
            }
            arrayOrdemLvl[item.level] +=    '                           </div>' +
                                    '                       </div>' +
                                    '                   </div>';
        }
    });
    var indicadorCategoryAdicional='';
    for(i=0; i<categories.length; i++){
        indicadorCategoryAdicional += arrayOrdemLvl[i];
    }
    return indicadorCategoryAdicional+indicatorCategory;
}

function generateListFilters(){
    var filterCategory = '';

    categories.filter(function (categoria) {
        return categoria.type === 'FILTER';
    }).forEach(function(item) {
        filterCategory +=
            '<div style="border-bottom: 1px solid #E0E0E0;" class="card">' +
            '   <div style="border: 0;" class="card-header" id="headingCard'+ item.id +'">' +
            '       <h5 class="mb-0">' +
            '           <button style="background-color: #fff;" class="btn btn-link" data-toggle="collapse" data-target="#collapse'+ item.id  +'" aria-expanded="true" aria-controls="collapseOne">' +
            '               <div class="robotoFamily" style="display: inline-block; text-overflow: ellipsis; overflow: hidden; width: 200px; height: 20px; white-space: nowrap;" title="'+ item.name +'">'+ item.name +' </div><i class="pull-right fa fa-angle-right" aria-hidden="true"></i>' +
            '           </button>' +
            '       </h5>' +
            '   </div>' +
            '   <div id="collapse'+ item.id  +'" class="collapse" aria-labelledby="headingCard'+ item.id +'" data-parent="#accordionFilter">' +
            '       <div class="card-body">';

        item['geographic-filters'].forEach(function(item) {
            filterCategory +=
                '       <div class="form-check-input" style="display: contents">'+
                '           <div class="custom-control custom-checkbox">'+
                '               <input type="checkbox" value="'+item.id+'" name="filtro"  class="filterCheckbox robotoFamily custom-control-input" id="checkbox-'+item.id+'">'+
                '               <label class="custom-control-label" style="line-height:24px" for="checkbox-'+item.id+'">'+item.name+'</label>'+
                '           </div>'+
                '       </div><br />';
        });
        filterCategory +=
            '       </div>' +
            '   </div>' +
            '</div>';
    });
    return filterCategory;
}


function genereteListLayer(){
    var layerCategory = '';
    categories.filter(function (categoria) {
        return categoria.type === 'LAYER';
    }).forEach(function(item) {

        layerCategory +=    '                   <div style="border-bottom: 1px solid #E0E0E0;" class="card">' +
            '                       <div style="border: 0;" class="card-header" id="headingCardLayer'+ item.id +'">' +
            '                           <h5 class="mb-0">' +
            '                               <button style="background-color: #fff;" class="btn btn-link" data-toggle="collapse" data-target="#collapsLayere'+ item.id  +'" aria-expanded="true" aria-controls="collapseOne">' +
            '                                   <div class="robotoFamily" style="display: inline-block; text-overflow: ellipsis; overflow: hidden; width: 200px; height: 20px; white-space: nowrap;" title="'+ item.name +'">'+ item.name +' </div><i class="pull-right fa fa-angle-right" aria-hidden="true"></i>' +
            '                               </button>' +
            '                           </h5>' +
            '                       </div>' +
            '                       <div id="collapsLayere'+ item.id  +'" class="collapse" aria-labelledby="headingCardLayer'+ item.id +'" data-parent="#accordion">' +
            '                           <div class="card-body">';

        item['group-layers'].forEach(function(layer) {
            layerCategory +=    '               <div class="form-check">' +
                '                                   <div class="custom-control custom-checkbox">' +
                '                                       <input class="custom-control-input form-check-input layerCheckbox" name="layerCheckbox" type="checkbox" value="'+ layer.id +'" id="layer'+ layer.id +'" />' +
                '                                       <label class="custom-control-label form-check-label robotoFamily" for="layer'+ layer.id +'">' +
                '                                           '+ layer.name +
                '                                       </label>' +
                '                                   </div>' +
                '                               </div>';
        });

        layerCategory +=    '                           </div>' +
            '                       </div>' +
            '                   </div>';

    });
    return layerCategory;
}

// Choropleth map

// Retorna o valor da regiao em Float, passando o geoCode e o Array de dados
function matchKey(datapoint, key_variable){
    return(key_variable[datapoint]);
    
};

getGradientColor = function(start_color, end_color, percent) {
   // strip the leading # if it's there
   start_color = start_color.replace(/^\s*#|\s*$/g, '');
   end_color = end_color.replace(/^\s*#|\s*$/g, '');

   // convert 3 char codes --> 6, e.g. `E0F` --> `EE00FF`
   if(start_color.length == 3){
     start_color = start_color.replace(/(.)/g, '$1$1');
   }

   if(end_color.length == 3){
     end_color = end_color.replace(/(.)/g, '$1$1');
   }

   // get colors
   var start_red = parseInt(start_color.substr(0, 2), 16),
       start_green = parseInt(start_color.substr(2, 2), 16),
       start_blue = parseInt(start_color.substr(4, 2), 16);

   var end_red = parseInt(end_color.substr(0, 2), 16),
       end_green = parseInt(end_color.substr(2, 2), 16),
       end_blue = parseInt(end_color.substr(4, 2), 16);

   // calculate new color
   var diff_red = end_red - start_red;
   var diff_green = end_green - start_green;
   var diff_blue = end_blue - start_blue;

   diff_red = ( (diff_red * percent) + start_red ).toString(16).split('.')[0];
   diff_green = ( (diff_green * percent) + start_green ).toString(16).split('.')[0];
   diff_blue = ( (diff_blue * percent) + start_blue ).toString(16).split('.')[0];

   // ensure 2 digits by color
   if( diff_red.length == 1 ) diff_red = '0' + diff_red
   if( diff_green.length == 1 ) diff_green = '0' + diff_green
   if( diff_blue.length == 1 ) diff_blue = '0' + diff_blue

   return '#' + diff_red + diff_green + diff_blue;
};

// get color depending on population density value
function getColor(d) {
	//Funcao abaixo alterada para gradiente logaritmica
	//Para reverter (logaritmica -> linear) basta remover a funcao Math.log()
    var porcento=(Math.log10(d) - Math.log10(minValue)) / (Math.log10(maxValue) - Math.log10(minValue))/2
    if(d >= minValue && d <= midValue){
        if (midValue!=minValue) {
            colorValueTemp=getGradientColor(minColor, midColor, (Math.log10(d) - Math.log10(minValue)) / (Math.log10(midValue) - Math.log10(minValue)))
        } else {
            colorValueTemp=maxColor
        }
        return colorValueTemp;
    }else if (d > midValue && d <= maxValue) {
        if (midValue!=maxValue) {
            colorValueTemp=getGradientColor(midColor, maxColor, (Math.log10(d) - Math.log10(midValue)) / (Math.log10(maxValue) - Math.log10(midValue)))
        } else {
            colorValueTemp=maxColor
        }
        return colorValueTemp;
    }
    return '#CBD8DD';
}

// Retorna a porcetatem para a barra de range de valores
function getPercent(d) {
    return ((Math.log10(d) - Math.log10(minValue)) / (Math.log10(maxValue) - Math.log10(minValue))) * 100;
}

// pinta a regiao
function style_1(feature) {
    // try{
    //     corMapa=getColor(matchKey(feature.geoCode, indicatorArray))
    // }catch{
    //     corMapa=maxColor
    // }
    return {
        fillColor: getColor(matchKey(feature.geoCode, indicatorArray)),
        weight: (feature.geoCode.toString().length > 2) ? 0.1 : 1,
        opacity: 1,
        color: '#146678',
        fillOpacity: 0.8
    };
}
// Choropleth map

function style_2(feature) {
    return {
        fillColor: getColor(arrayCompleto.find(element => element.region.name == feature.properties.name.toString()).value),
        weight: (feature.properties.name.toString().length > 2) ? 0.1 : 1,
        opacity: 1,
        color: '#146678',
        fillOpacity: 0.8
    };
}

// Funcao para retornar o menor valor de um array
Array.min = function(array) {
    return Math.min.apply(Math, array);
};

// Funcao para retornar o maior valor de um array
Array.max = function(array) {
    return Math.max.apply(Math, array);
};

// Funcao para setar os valores das variaveis com base no json
function setJsonVars(json) {
    var values = Object.values(json);
    minValue = Array.min(values);
    maxValue = Array.max(values);
    midValue = Math.pow(10,(Math.log10(maxValue) + Math.log10(minValue)) / 2);
    //console.log('ooooo:',minValue,maxValue,midValue)
}

// MenuMapControl
function menuMapControl(){
    let pos = ($(".menu--popup").css('right') == '0px') ? '-340px' : '0';
    $(".menu--popup").animate({right: pos}, 800);
    let pos2 = ($(".leaflet-right.leaflet-bottom").css('right') == '0px') ? '340px' : '0';
    $(".leaflet-right.leaflet-bottom").animate({right: pos2}, 800);
    $('#seta-sidebar').toggle();
}
//Função para fazer a escolha de Estado/Municipio
function rangeMap(select){
    $("#loading").show();
    // console.log(select.value);
    map.removeLayer(group);
    emptyMap();
    switch(select) {
        case "4":
            makeChart(4);
            $('#estMunMostrado').html('País');
            $("#loading").hide();
            break;
        case "3":
            makeChart(3);
            $("#loading").hide();
            break;
        case "2":
            makeChart(2);
            $('#estMunMostrado').html('Municípios');
            $("#loading").hide();
            break;
        case "1":
            makeChart(1);
            $('#estMunMostrado').html('Estados');
            $("#loading").hide();
            break;
    }
}

function cleanMap(){
    map.removeLayer(group);
    if (typeof(filtroMapControl) != "undefined") {
        //indicadorMapControl.remove(map);
        filtroMapControl.remove(map);
        rangeBarControl.remove(map);
        mapControl.remove(map);
        //styleMapControl.remove(map);
        infoIndicadorControl.remove(map)
        // minColor='#a64cdf';
        // midColor='#66baae';
        // maxColor='#d4e76e';
    }
}

function emptyMap(flag=-1){
    group.clearLayers();
    var mapOption = document.getElementById('#escolhaEstMun');

    if( mapOption === undefined ||  mapOption === null ){
        mapOption = 1;
    }

    var geoJsonToApply;
    if (flag > 0){
        if(pflag=='error'){
            alert('JsonPais com erro! Recarregando a página.')
            location.reload();
        }
        while(pflag==0){
            setTimeout(console.log('carregando json pais'), 1000)
        }    
        geoJsonToApply = pais;
    }else if(mapOption === 1){
        geoJsonToApply = estado;
    } else {
        geoJsonToApply = municipio;
    }

    indicatorArray = new Array();
        var route1Layer = L.geoJson(geoJsonToApply,
        {
            style: style_1

        });
        group.addLayer(route1Layer);
        map.addLayer(group);
    
}

// Set no mapa arquivo de regiões, função de popup nas regiões
function makeChart(rangeMap2) {
    
    var geoJson;
    switch(rangeMap2) {
        case 4:
            emptyMap(1);
            geoJson = pais;
            indicatorArray = paisArray;
            break;
        case 2:
            emptyMap();
            geoJson = municipio;
            indicatorArray = municipioArray;
        break;
        case 1:
            emptyMap();
            geoJson = estado;
            indicatorArray = estadoArray;
        break;
    }

    setJsonVars(indicatorArray);

    var route1Layer = L.geoJson(geoJson,
    {
        style: style_1,
        onEachFeature: function (feature, layer) {
            if (typeof indicatorArray[feature.geoCode] !== "undefined") {
                
                //debugar
                //str = JSON.stringify(arrayCompleto);
                //str = JSON.stringify(arrayCompleto, null, 4); // (Optional) beautiful indented output.
                //console.log(str);
                
                var str_porcentagem = '';
                
                if(arrayCompleto[0]['group']['typePresentation']['name'] == 'Porcentagem'){ 
                    console.log('GETTT INNNNn')
                    str_porcentagem = '%';
                }else{
                    str_porcentagem = '';
                }
                

                var popupValue = '<div style="cursor:pointer;" onclick="console.log(\''+feature.geoCode+'\');popupStart(\''+feature.geoCode+'\');">' +
                    '<p id="box_'+feature.geoCode+'" class="title-popup">'+feature.properties.name+'</p>' +
                    '<p id="both" style="font-style:normal; font-weight: 300; font-size: 14px; line-height: 16px; font-family:roboto color: #3D3D3D;">'+arrayCompleto[0].group.name+'</p>' +
                    '<p style="font-size: 18px; font-weight: 500; line-height: 21px; color: #146678;" id="dado-escolhido-popup">'+getFormattedPrintValue(arrayCompleto[0].group.typePresentation, indicatorArray[feature.geoCode])+ str_porcentagem +'</p>' +
                    '<p style="margin-bottom: 1">ver</p>'
                    '<div style="text-align: center">';



                var filtrosAplicados = filtrosPesquisados.get(parseInt(feature.geoCode));
                if(filtrosAplicados !== undefined){
                    filtrosAplicados.forEach(function (filterName) {
                        // alert('filter: ' + filterName);
                        popupValue += '<button class="button-popup">'+filterName+'</button></br>';
                    });
                }
                popupValue += '</div> </div>';

                layer.bindPopup(popupValue);

                layer.on('mouseover', function (e) {
                    var x = document.getElementsByClassName("range-bar-mark")[0];
                    x.style.left = getPercent(indicatorArray[feature.geoCode])*0.92+"%";
                    x.style.display = "inline";
                    $("#box"+feature.geoCode).toggle();
                });
                layer.on('mouseout', function (e) {
                    var x = document.getElementsByClassName("range-bar-mark")[0];
                    x.style.display = "none";
                    $("#box"+feature.geoCode).toggle();
                });
            } else {
                var popupValue = '<div>' +
                    '<p id="box_'+feature.geoCode+'" class="title-popup">'+feature.properties.name+'</p>' +
                    '<p id="both" style="margin-bottom: 0">'+arrayCompleto[0].group.name+'</p>' +
                    '<p style="font-size: 16px; margin-top: 0; font-weight: bold">Não há dados sobre a região selecionada nesse período.</p>' +
                    '<div style="text-align: center">' +
                    '</div> </div>';
                layer.bindPopup(popupValue);
            }
        }
    });

    $("#loading").hide();

    group.addLayer(route1Layer);
    console.log(group);
    map.addLayer(group);

    function getFormattedPrintValue(typePresentation, valueToShow){
        if(typePresentation !== null && typePresentation.display.includes("$")){
            return typePresentation.display + valueToShow.toLocaleString('pt-br', {minimumFractionDigits: 2});
        } if(isJson(typePresentation.display)) {
            var display = JSON.parse(typePresentation.display);
            return display[valueToShow];
        }
        else {
            return valueToShow.toLocaleString('pt-br');
        }
    }
}

function makeChart2(rangeMap2) {

    group.clearLayers();

    console.log(indicadorAtual);

    var geoJsonURL = "http://teste.visao.ibict.br/geoserver/IBICT/ows?service=WFS&version=1.0.0&request=GetFeature&outputFormat=application%2Fjson&typeName=IBICT:view_" + indicadorAtual;
    $.ajax({
        url: geoJsonURL,
        dataType: 'json',
        success: function (data) {

            console.log(data);

            console.log(arrayCompleto);

            var chave = new Array();
            var valor = new Array();
            arrayCompleto.forEach(function (indicator) {
                chave.push(indicator.region.geoCode.toString());
                valor.push(indicator.value);
            });

            setJsonVars(valor);

            function checkAdult(indicator) {
              return age >= 18;
            }


            var route1Layer = L.geoJson(data,
            {
                style: style_2,
                onEachFeature: function (feature, layer) {
                   var indicador = arrayCompleto.find(element => element.region.name == feature.properties.name.toString());
                   if (typeof indicador.region.geoCode !== "undefined") {

                    
                    var popupValue = '<div style="cursor:pointer;" onclick="console.log(\''+feature.properties.name+'\');popupStart(\''+feature.properties.name+'\');">' +
                    '<p id="box_'+feature.properties.name+'" class="title-popup">'+feature.properties.name+'</p>' +
                    '<p id="both" style="font-style:normal; font-weight: 300; font-size: 14px; line-height: 16px; font-family:roboto color: #3D3D3D;">'+indicador.group.name+'</p>' +
                    '<p style="font-size: 18px; font-weight: 500; line-height: 21px; color: #146678;" id="dado-escolhido-popup">'+getFormattedPrintValue(indicador.group.typePresentation, indicador.value)+'</p>' +
                    '<p style="margin-bottom: 1">ver</p>'
                    '<div style="text-align: center">';

                    var filtrosAplicados = filtrosPesquisados.get(parseInt(feature.properties.name.toString()));
                    if(filtrosAplicados !== undefined){
                        filtrosAplicados.forEach(function (filterName) {
                            popupValue += '<button class="button-popup">'+filterName+'</button></br>';
                        });
                    }
                    popupValue += '</div> </div>';

                    layer.bindPopup(popupValue);

                    layer.on('mouseover', function (e) {
                        var x = document.getElementsByClassName("range-bar-mark")[0];
                        x.style.left = getPercent(indicatorArray[feature.properties.name.toString()])*0.92+"%";
                        x.style.display = "inline";
                        $("#box"+feature.geoCode).toggle();
                    });
                    layer.on('mouseout', function (e) {
                        var x = document.getElementsByClassName("range-bar-mark")[0];
                        x.style.display = "none";
                        $("#box"+feature.geoCode).toggle();
                    });
                } else {
                    var popupValue = '<div>' +
                        '<p id="box_'+feature.properties.name.toString()+'" class="title-popup">'+indicador.region.name+'</p>' +
                        '<p id="both" style="margin-bottom: 0">'+indicador.group.name+'</p>' +
                        '<p style="font-size: 16px; margin-top: 0; font-weight: bold">Não há dados sobre a região selecionada nesse período.</p>' +
                        '<div style="text-align: center">' +
                        '</div> </div>';
                    layer.bindPopup(popupValue);
                }
                }
            });

            
            $("#loading").hide();
            
            group.addLayer(route1Layer);
            console.log(group);
            map.addLayer(group);
            
            function getFormattedPrintValue(typePresentation, valueToShow){
                if(typePresentation !== null && typePresentation.display.includes("$")){
                    return typePresentation.display + valueToShow.toLocaleString('pt-br', {minimumFractionDigits: 2});
                }else if(isJson(typePresentation.display)) {
                    var display = JSON.parse(typePresentation.display);
                    return display[valueToShow];
                }
                else if(typePresentation.display != 1 && typePresentation.display!= '%'){
                    return valueToShow.toLocaleString('pt-br') +' ' +typePresentation.display;
                }else{
                    return valueToShow.toLocaleString('pt-br');
                }
            }
            
         }
    });


}

function updateOpacity(value) {
    group.setStyle({fillOpacity:value});
}

function isJson(item) {
    item = typeof item !== "string"
        ? JSON.stringify(item)
        : item;

    try {
        item = JSON.parse(item);
    } catch (e) {
        return false;
    }

    if (typeof item === "object" && item !== null) {
        return true;
    }

    return false;
}


function setLayer(json){
    json.forEach(function(item) {
        let desc = '';
        var polygons = new L.FeatureGroup();
        console.log(item.id);
        item.geoJsonDebug = JSON.parse(item.geoJson);
        console.log(item);
        switch(item.type){
            case "MARKER":
                var latlong = JSON.parse(item.geoJson);
                var marker = new L.Marker(latlong);
                desc += ((typeof item.name === 'string' || item.name instanceof String) && item.name.length !== 0)
                                ? "Nome: " + item.name + "<br />" : '';
                desc += ((typeof item.description === 'string' || item.description instanceof String) && item.description.length !== 0)
                                ? "Descrição: " + item.description + "<br />" : '';
                desc += ((typeof item.source === 'string' || item.source instanceof String) && item.source.length !== 0)
                                ? "Fonte: " + item.source + "<br />" : '';
                desc += ((typeof item.note === 'string' || item.note instanceof String) && item.note.length !== 0)
                                ? "Notas: " + item.note + "<br />" : '';
                marker.bindPopup(desc);
                markers.addLayer(marker);
            break;
            case "CIRCLE":
                var circle = JSON.parse(item.geoJson);
                L.circle(circle.latlong, {
                    color: 'red',
                    fillColor: '#f03',
                    fillOpacity: 0.5,
                    radius: circle.radius
                }).addTo(mymap);

            break;
            case "POLYGON":
                let geon = JSON.parse(item.geoJson);

               // let polygon = new L.polygon(geon);
                var polygon = L.polygon(geon).addTo(map);
                //polygon.bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup();

                desc += ((typeof item.name === 'string' || item.name instanceof String) && item.name.length !== 0)
                                ? "Nome: " + item.name + "<br />" : '';
                desc += ((typeof item.description === 'string' || item.description instanceof String) && item.description.length !== 0)
                                ? "Descrição: " + item.description + "<br />" : '';
                desc += ((typeof item.source === 'string' || item.source instanceof String) && item.source.length !== 0)
                                ? "Fonte: " + item.source + "<br />" : '';
                desc += ((typeof item.note === 'string' || item.note instanceof String) && item.note.length !== 0)
                                ? "Notas: " + item.note + "<br />" : '';
                //console.log(polygon);
                polygon.bindPopup(desc);
                //polygons.addLayer(polygon);
                //polygon.addTo(map);
                //L.polygon(polygon).addTo(map);
            break;
            case "ICON":
                var latlong = JSON.parse(item.geoJson);
                var greenIcon = L.icon({
                    iconUrl: 'leaf-green.png',
                    shadowUrl: 'leaf-shadow.png',

                    iconSize:     [38, 95], // size of the icon
                    shadowSize:   [50, 64], // size of the shadow
                    iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
                    shadowAnchor: [4, 62],  // the same for the shadow
                    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
                });
                var marker = new L.Marker(latlong, {icon: greenIcon});
                markers.addLayer(marker);
            break;
            case "CUSTOM_MARKER":

                var icon = L.icon({
                    // DEVE SER EVOLUIDO NO FUTURO
                    iconUrl: item.path,
                    iconSize:     [50, 50], // size of the icon
                    iconAnchor:   [15, 50], // point of the icon which will correspond to marker's location
                    shadowAnchor: [4, 62],  // the same for the shadow
                    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
                });

                var latlong = JSON.parse(item.geoJson);
                var marker = new L.Marker(latlong, {icon: icon});
                let description = '';
                description += ((typeof item.name === 'string' || item.name instanceof String) && item.name.length !== 0)
                                ? "Nome: " + item.name + "<br />" : '';
                description += ((typeof item.description === 'string' || item.description instanceof String) && item.description.length !== 0)
                                ? "Descrição: " + item.description + "<br />" : '';
                description += ((typeof item.source === 'string' || item.source instanceof String) && item.source.length !== 0)
                                ? "Fonte: " + item.source + "<br />" : '';
                description += ((typeof item.note === 'string' || item.note instanceof String) && item.note.length !== 0)
                                ? "Notas: " + item.note + "<br />" : '';
                marker.bindPopup(description);
                markers.addLayer(marker);
            break;
        }
    });
    map.addLayer(markers);
    //map.addLayer(polygons);
}

function setYears(nameId) {
    var yearsOptions = '';
    $.ajax({
        headers: {
            "Authorization": "Bearer " + apiKey
        },
        url: host+'/api/yearsDistinct?&groupId.equals='+nameId,
        dataType: 'json',
        async: false,
        success: function (data) {
            anoId = data[0].id;
            data.forEach(function(item) {
                var d = new Date(item.date);
                //yearsOptions += '<option value="' + item.id +'">' + item.date.slice(0,10).replace(/-/g,'/') + '</option>';
                yearsOptions += '<option value="' + item.id +'">' + d.toLocaleDateString() + '</option>';

                
                //yearsOptions += '<option value="' + item.id +'">' + item.date.slice(0,10).replace(/-/g,'/') + '</option>';
            });
        }
    });
    return yearsOptions;
}

function changeYear(yearOption){
    $("#loading").show();
    emptyMap();
    map.removeLayer(group);
    anoId=yearOption.value;
    var urlQuery = '';
    if(filtrosId.size === 0){
        urlQuery += host+'/api/indicators?yearId.equals='+yearOption.value+'&groupId.equals='+indicadorAtual;
    } else {
        var vetor = new Array();
        filtrosId.forEach(function (filtro) {
            vetor.push(filtro);
        });
        var stringResult = vetor.join(',');
        urlQuery += host+'/api/indicatorsFilter?yearId.equals='+yearOption.value+'&filtersId.in='+stringResult+'&groupId.equals='+indicadorAtual;

        $.ajax({
            headers: {
                "Authorization": "Bearer " + apiKey
            },
            url: host+'/api/regionsWithFilter?yearId.equals='+yearOption.value+'&filtersId.in='+stringResult,
            dataType: 'json',
            success: function (dataJson) {
                filtrosPesquisados = new Map();
                dataJson.forEach(function (dto) {
                    var contains = filtrosPesquisados.get(dto.geocode);
                    if(contains === undefined){
                        filtrosPesquisados.set(dto.geocode, []);
                        contains = filtrosPesquisados.get(dto.geocode);
                    }

                    contains.push(dto.filtername);
                });
            }
        });
    }

    console.log(urlQuery);
    $.ajax({
        headers: {
            "Authorization": "Bearer " + apiKey
        },
        url: urlQuery,
        //timeout: 10000,
        //error: function (xhr, ajaxOptions, thrownError) {
        //  alert(xhr.status);
        //  alert(thrownError);
        //},
        dataType: 'json',
        success: function (dataJson) {

            if (dataJson.length < 1) {
                $("#loading").hide();
                emptyMap();
            }
            else {
                arrayCompleto = dataJson;
                console.log(arrayCompleto);
                municipioArray = new Array();
                estadoArray = new Array();
                paisArray = new Array();

                dataJson.forEach(function (indicator) {

                    if (indicator.region.typeRegion == "MUNICIPIO") {
                        municipioArray[indicator.region.geoCode.toString()] = indicator.value;
                    } else if (indicator.region.typeRegion == "ESTADO") {
                        estadoArray[indicator.region.geoCode.toString()] = indicator.value;
                        return;
                    } else if (indicator.region.typeRegion == "PAIS") {
                        paisArray[indicator.region.geoCode.toString()] = indicator.value;

                    }

                });

                itensSelect[0] = '<option value="1">Estado</option>';
                itensSelect[1] = '<option value="2">Municipio</option>';
                itensSelect[2] = '<option value="4">País</option>';

                if (Object.keys(paisArray).length > 0){
                        valorAtualLido='País';
                        if (municipioArray.length < 1){
                            delete itensSelect[1];
                        }
                        if (estadoArray.length < 1){
                            delete itensSelect[0];
                        }
                        makeChart(4);
                } else if (estadoArray.length > 0) {
                    delete itensSelect[2];
                    if (municipioArray.length < 1){
                        delete itensSelect[1];
                    }
                    makeChart(1);
                } else if (municipioArray.length > 0) {
                    delete itensSelect[0];
                    delete itensSelect[2];
                    makeChart(2);
                } else {
                    console.error("Empty DATAJSON")
                }
            }
            $("#loading").hide();
        }
    });
}

function limparMap() {
    location.reload();
}

function makeMap() {

    $("#loading").hide();

    emptyMap();

    //Functions to either disable (onmouseover) or enable (onmouseout) the map's dragging
    function controlEnter(e) {
        map.dragging.disable();
        map.scrollWheelZoom.disable();
    }
    function controlLeave() {
        map.dragging.enable();
        map.scrollWheelZoom.enable();
    }

    // Menu Map control
    var menuMapControl = L.control({position: 'topright'});
    menuMapControl.onAdd = function(map) {
                this._div = L.DomUtil.create('div', 'leaflet-bar easy-button-container menuMapControl');
                this._div.innerHTML = '<div>' +
                                      '<div style="border-radius:4px; background-color: rgba(255,255,255,0.9); color: #59C9A8; font-size: 28px; padding: 1px 10px;" onclick="menuMapControl()"><i class="fa fa-sliders"></i></div>' +
                                      ' <div class="menu--popup">' +
                                      '     <ul class="nav nav-tabs" id="myTab" role="tablist">' +
                                      '         <li class="nav-item">' +
                                      '             <a class="nav-link active robotoFamily" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">INDICADORES</a>' +
                                      '         </li>' +
                                      '         <li class="nav-item">' +
                                      '             <a class="nav-link robotoFamily" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">FILTROS</a>' +
                                      '         </li>' +
                                      '         <li class="nav-item">' +
                                      '             <a class="nav-link robotoFamily" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false">CAMADAS</a>' +
                                      '         </li>' +
                                      '     </ul>' +
                                      '     <div class="tab-content" id="myTabContent">' +
                                      '         <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">' +
                                      '             <div id="accordion">' +
                                                        genereteListIndicators() +
                                      '             </div>' +
                                      '         </div>' +
                                      '         <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">' +
                                      '             <div id="accordionFilter">' +
                                                        generateListFilters() +
                                      '             </div>'+
                                      '             <div id="selectedIndicator" style="text-align: center;"><span> Não há indicador selecionado</span></div>' +
                                      '         </div>' +
                                      '         <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">' +
                                                        genereteListLayer() +
                                                '</div>' +
                                      '     </div>' +
                                      '     <span id="seta-sidebar" onclick="menuMapControl()" style="position:absolute;left: -40px;top: 0;color:white;background-color: #59C9A8;padding: 4px 12px;border-radius:4px 0 0 4px;font-size: 22px;"><span class="fa fa-chevron-right"> </span></span>' +
                                      '     <div id="footer-sidebar-filtros">' +
                                      '         <div class="pull-left" style="width:60%;min-height:1px;margin-top:20px">' +
                                      '             <div class="indicador" style="text-align:center"></div>' +
                                      '             <div class="filtro" style="margin: 10px 45px 0 0;"></div>' +
                                      '         </div>' +
                                      '         <div class="pull-left" style="width:40%;padding-right:20px">' +
                                      '             <button id="submitFormIndicator" disabled style="margin: 15px 15px 0; background-color: #146678; color: #fff;" class="btn pull-right robotoFamily">Aplicar</button><br>' +
                                      '             <button id="clearFormIndicator" style="margin: 0 5px; background-color: #f5f6f6; color: #146678;" class="btn pull-right robotoFamily">Limpar&nbsp;<span class="fa fa-trash-o"></span></button>' +
                                      '         </div>' +
                                      '     </div>' +
                                      ' </div>' +
                                      '</div>';


                    L.DomEvent.addListener(this._div, 'dblclick', L.DomEvent.stop);

                return this._div;jhiTranslate="global.menu."
    }
    menuMapControl.addTo(map);

    document.getElementsByClassName("menuMapControl")[0].onmouseover = controlEnter;
    document.getElementsByClassName("menuMapControl")[0].onmouseout = controlLeave;

    $('#accordion .card').on('hidden.bs.collapse', function () {
        $(this).find( "i" ).removeClass("fa-angle-down");
        $(this).find( "i" ).addClass("fa-angle-right");
    });

    $('#accordion .card').on('shown.bs.collapse', function () {
        $(this).find( "i" ).addClass("fa-angle-down");
        $(this).find( "i" ).removeClass("fa-angle-right");
    });

    $('#accordionFilter .card').on('hidden.bs.collapse', function () {
        $(this).find( "i" ).removeClass("fa-angle-down");
        $(this).find( "i" ).addClass("fa-angle-right");
    });

    $('#accordionFilter .card').on('shown.bs.collapse', function () {
        $(this).find( "i" ).addClass("fa-angle-down");
        $(this).find( "i" ).removeClass("fa-angle-right");
    });

    $('input[type=radio][name=indicator]').change(function() {
        indicadorAtual = this.value;
        indicadorSelecionado = indicadorAtual;
        $('#selectedIndicator').html("<span id='msgIndicadorSelecionado'>Indicador <b>"+$(this.nextElementSibling).text().trim()+"</b> selecionado</span>");
        $('#submitFormIndicator').prop('disabled', false);
    });

    $('input[type=checkbox][name=filtro]').change(function () {
        if($('.layerCheckbox:checked').val() !== undefined){
            $('#submitFormIndicator').prop('disabled', false);
        }
    });

    $('input[type=checkbox][name=layerCheckbox]').change(function () {
        if($('input[type=checkbox][name=layerCheckbox]:checked').length > 0)
            $('#submitFormIndicator').prop('disabled', false);
        else if($('input[type=radio][name=indicator]:checked').val() === undefined)
            $('#submitFormIndicator').prop('disabled', true);
    });

    // Method to clear the lateral form
    $('#clearFormIndicator').click(function () {
        $('.menu--popup').find(':input').each(function () {
            if(this.type === 'checkbox' || this.type === 'radio'){
                this.checked = false;
            }
        });

        indicadorAtual = undefined;
        $('#selectedIndicator').html("<span> Não há indicador selecionado</span>");
        $('#submitFormIndicator').prop('disabled', true);
    });

    function loadResultMap(urlQuery) {
        $.ajax({
            headers: {
                "Authorization": "Bearer " + apiKey
            },
            url: urlQuery,
            //timeout: 10000,
            //error: function (xhr, ajaxOptions, thrownError) {
            //  alert(xhr.status);
            //  alert(thrownError);
            //},
            dataType: 'json',
            success: function (dataJson) {

                if (dataJson.length < 1) {
                    $("#loading").hide();
                    emptyMap();
                }
                else {
                    arrayCompleto = dataJson;
                    console.log(arrayCompleto);
                    municipioArray = new Array();
                    estadoArray = new Array();
                    paisArray = new Array();

                    if (indicadorAtual > 180 & indicadorAtual < 189 | indicadorAtual > 223 & indicadorAtual < 247){
                        itensSelect[0] = '<li onmousedown="rangeMap(\'3\')"><i class="fa fa-circle-o iconeTarget" aria-hidden="true"></i><a class="opcaoEstados opcaoGradientes" >Setor Censitário</a></li>';
                    } else {

                        dataJson.forEach(function (indicator) {

                            if (indicator.region.typeRegion == "MUNICIPIO") {
                                municipioArray[indicator.region.geoCode.toString()] = indicator.value;
                            } else if (indicator.region.typeRegion == "ESTADO") {
                                estadoArray[indicator.region.geoCode.toString()] = indicator.value;
                                return;
                            } else if (indicator.region.typeRegion == "PAIS") {
                                paisArray[indicator.region.geoCode.toString()] = indicator.value;

                            }
                        });


                        itensSelect[0] = '<li onmousedown="rangeMap(\'1\')"><i class="fa fa-circle-o iconeTarget" aria-hidden="true"></i><a class="opcaoEstados opcaoGradientes" >Estados</a></li>';
                        itensSelect[1] = '<li onmousedown="rangeMap(\'2\')"><i class="fa fa-circle-o iconeTarget" aria-hidden="true"></i><a class="opcaoEstados opcaoGradientes" >Municípios</a></li>';
                        itensSelect[2] = '<li onmousedown="rangeMap(\'4\')"><i class="fa fa-circle-o iconeTarget" aria-hidden="true"></i><a class="opcaoEstados opcaoGradientes" >País</a></li>';

                    }

                    var valorAtualLido='';
                    if (Object.keys(paisArray).length > 0){
                        valorAtualLido='País';
                        if (municipioArray.length < 1){
                            delete itensSelect[1];
                        }
                        if (estadoArray.length < 1){
                            delete itensSelect[0];
                        }
                        makeChart(4);
                    } else if (estadoArray.length > 0) {
                        valorAtualLido='Estados';
                        delete itensSelect[2];
                        if (municipioArray.length < 1){
                            delete itensSelect[1];
                        }
                        makeChart(1);
                    } else if (municipioArray.length > 0) {
                        delete itensSelect[0];
                        delete itensSelect[2];
                        makeChart(2);
                        valorAtualLido='Municípios';
                    } else if (indicadorAtual > 180 & indicadorAtual < 189 | indicadorAtual > 223 & indicadorAtual < 247){
                        console.log("SETOR")
                        makeChart2(3);
                    } else {
                        console.log("Empty DATAJSON")
                    }
                    
                    // html do SELECT
                    var selectRangeMapHtml = '<div class="input-group input-group-sm mb-3" style="bottom:1rem;">' +
                        '<div class="input-group-prepend">' +
                        '<span  class="input-group-text fa fa-map input-leaflet" id="basic-addon1"></span>' +
                        '</div>' +
                        '<div >'+
                        '<button id="escolhaEstMun" onclick="abrirListaGrad($(this),\'parteEstMun\')"><i class="fa fa-dot-circle-o iconeTarget" aria-hidden="true"></i><span id="estMunMostrado">'+valorAtualLido+'</span></button>'+
                        '<div class="parteEstMun">' +
                            '<span class="upper Escolha-estMun-titulo">Detalhamento <br> geográfico</span>'+
                            '<ul class="estMun">';

                    itensSelect.forEach(function (iten) {
                        selectRangeMapHtml += iten;
                    });

                    selectRangeMapHtml += '</ul>'+
                                            '</div>' +
                                            '</div>' +
                                            '</div>';
                    // html do SELECT

                    // indicador Map control
              //      indicadorMapControl = L.control({position: 'topright'});
            //        indicadorMapControl.onAdd = function (map) {
          //              this._div = L.DomUtil.create('div', 'indicadorMapControl');
        //                this._div.innerHTML = '<div style="cursor: pointer;color:#59C9A8; font-size:16px;" onclick="infoAboutIndicator()" class="" id="indicadorMapControl" title="Menu">' +
      //                      '<span class="robotoFamily filtro-selecionado" onclick="abrirAbaFiltro(\''+dataJson[0].group.name+'\'); mostrargraf(true);">' +
    //                        dataJson[0].group.name + ' <span style="background-color: #59C9A8; padding:3.5px 6.5px; color: white; border-radius: 4px; font-size:8px; position:relative;top: -2.5px;" class="fa fa-info"></span>' +
  //                          '</span></div>';
//
  //                      $("#footer-sidebar-filtros .indicador").html(this._div.innerHTML);
//
          //                   L.DomEvent.addListener(this._div, 'dblclick', L.DomEvent.stop);
 //                     L.DomEvent.addListener(this._div, 'mousedown', L.DomEvent.stop);
//                       L.DomEvent.addListener(this._div, 'mouseup', L.DomEvent.stop);
//
                    //    return this._div;
                    //}
                    //indicadorMapControl.addTo(map);

                    // filtro Map control
                    filtroMapControl = L.control({position: 'topright'});
                    filtroMapControl.onAdd = function (map) {
                        this._div = L.DomUtil.create('div', 'filtroMapControl');

                        if (filtrosId.size !== 0) {
                            this._div.innerHTML = loadFiltrosSelecionados();
                        }

                        L.DomEvent.addListener(this._div, 'dblclick', L.DomEvent.stop);
                        L.DomEvent.addListener(this._div, 'mousedown', L.DomEvent.stop);
                        L.DomEvent.addListener(this._div, 'mouseup', L.DomEvent.stop);

                        return this._div;
                    }
                    filtroMapControl.addTo(map);

                    var sliderOpacidade = '<div style="background-color: white;border-radius: 10px;padding: 2px 6px; color: #bdbdbd; width: 156px;">' +
                                          '<i class="fa fa-adjust"></i>&nbsp;' +
                                          '0 <input id="sliderOpacidade" type="range" min="0" max="1" step="0.1" value="0.8" onchange="updateOpacity(this.value)"> 100' +
                                          '</div>';

                    // range bar Map control
                    rangeBarControl = L.control({position: 'bottomright'});
                    rangeBarControl.onAdd = function (map) {
                        this._div = L.DomUtil.create('div', 'rangeBarControl');
                        this._div.innerHTML = '' +
                            '<div class="Newgradientbuttons">'+
                                '<div style="background: linear-gradient(90deg, #F2A141 0%, #EC536F 32.81%, #B54180 65.63%, #6F0417 100%);'+gradiente1+'" id="Newgradientbutton1" class="NewgradientbuttonClass" onmousedown="changeColorFunc(this); styleMapFunc(\'2\');$(\'#submitFormIndicator\').click();"></div>'+    
                                '<div style="background: linear-gradient(90deg, #8EBF45 0%, #CBD977 32.15%, #D98D30 67.71%, #E76262 100%);'+gradiente2+'" id="Newgradientbutton2" class="NewgradientbuttonClass" onmousedown="changeColorFunc(this); styleMapFunc(\'3\');$(\'#submitFormIndicator\').click();"></div>'+    
                                '<div style="background: linear-gradient(270deg, #A64BDF 0%, #59C9A8 46.87%, #D5E86E 100%);'+gradiente3+'" id="Newgradientbutton3" class="NewgradientbuttonClass" onmousedown="changeColorFunc(this); styleMapFunc(\'1\');$(\'#submitFormIndicator\').click();"></div>'+    
                            '</div>'+
                            '<i class="fa fa-minus" aria-hidden="true"></i><div class="range-bar" style="background-image:'+gradientesIniciais+'">' +
                            '<span class="range-bar-mark"></span>' +
                            '</div><i class="fa fa-plus" aria-hidden="true"></i>' +
                            '<select onchange="changeYear(this)" class="select-year">' +
                                setYears(indicadorAtual) +
                            '</select>' + sliderOpacidade;


                        return this._div;
                    }
                    rangeBarControl.addTo(map);
                    document.getElementsByClassName("rangeBarControl")[0].onmouseover = controlEnter;
                    document.getElementsByClassName("rangeBarControl")[0].onmouseout = controlLeave;

                    // select Map control
                    mapControl = L.control({position: 'bottomleft'});
                    mapControl.onAdd = function (map) {
                        this._div = L.DomUtil.create('div', 'mapControl');
                        this._div.innerHTML = selectRangeMapHtml;

                        L.DomEvent.addListener(this._div, 'dblclick', L.DomEvent.stop);

                        return this._div;
                    }
                    mapControl.addTo(map);

                    document.getElementsByClassName("mapControl")[0].onmouseover = controlEnter;
                    document.getElementsByClassName("mapControl")[0].onmouseout = controlLeave;
                
                    
                    
                     // html do informações do indicador
                     var infoIndicadorHtml = '<div class="initialtest" style="backgroundcolor=white; height:10rem">' +
                                                '<div class="miniInfoPopup" >'+
                                                    '<div>'+
                                                        '<p class="titleInfoInd1" style="margin-bottom:0.75rem">INDICADOR APLICADO</p>'+
                                                        '<p class="titleInfoInd2" id="Indicador-popup" style="margin-bottom:0rem"></p>'+
                                                        '<p class="titleInfoInd2" style="margin-bottom:0.75rem; font-weight: bold;">'+dataJson[0].group.name+'</p>'+

                                                    '</div>'+
                                                    '<div id="newdivTextoInfoInd" style="height=5rem;">'+
                                                        '<div style="max-height: 3.75rem; overflow-y:auto">'+
                                                            '<p class="info-sobre-ind2" style="">'+dataJson[0].group.description+'</p>'+
                                                        '</div>'+
                                                        '<div style="bottom: -0.4rem;">' +
                                                            '<span><p id="link-fonte2" style="word-wrap: break-word;"><a id="link-popup2">Fonte: NA</a></p></span>'+
                                                        '</div>'+
                                                    '</div>'+
                                            
                                                '</div>'+
                                            '</div>';
                        
                    

                    // select style Map control
                    infoIndicadorControl = L.control({position: 'bottomleft'});
                    infoIndicadorControl.onAdd = function (map) {
                        this._div = L.DomUtil.create('div', 'infoIndicadorControl');
                        this._div.innerHTML = infoIndicadorHtml;

                        L.DomEvent.addListener(this._div, 'dblclick', L.DomEvent.stop);

                        return this._div;
                    }
                    infoIndicadorControl.addTo(map);

                    document.getElementsByClassName("infoIndicadorControl")[0].onmouseover = controlEnter;
                    document.getElementsByClassName("infoIndicadorControl")[0].onmouseout = controlLeave;
                    //console.log(dataJson);
                    abrirAbaFiltro2(dataJson[0].group.source,dataJson[0].group.id);

                    

                    
                
                }
            }
        });
    }

    $('#submitFormIndicator').click(function() {

        itensSelect = new Array();

        filtrosId = new Set();
        $('#accordionFilter input:checkbox:checked').map(function(){
            filtrosId.add(parseInt($(this).val()));
        });

        layersId = new Set();
        $('input[name=layerCheckbox]:checkbox:checked').map(function(){
            layersId.add(parseInt($(this).val()));
        });

        markers.clearLayers();
        if(layersId.size != 0){
            layersId.forEach(function (layerId) {
                var strQuery ="?groupId.equals="+layerId+"&";
                $.ajax({
                    headers: {
                        "Authorization": "Bearer " + apiKey
                    },
                    url: host+'/api/layers'+strQuery,
                    dataType: 'json',
                    success: function (data) {
                        setLayer(data);
                    }
                });
            });
        }

        if(indicadorAtual !== undefined){
            cleanMap();

            group = new L.FeatureGroup();
            $("#loading").show();

            var urlQuery = '';
            if(filtrosId.size === 0){
                urlQuery += host+'/api/indicatorsMostRecentYear?&groupId.equals='+indicadorAtual;
                //urlQuery += host+'/api/indicators?&groupId.equals='+indicadorAtual;
                loadResultMap(urlQuery);

            } else {
                var vetor = new Array();
                filtrosId.forEach(function (filtro) {
                    vetor.push(filtro);
                });
                var stringResult = vetor.join(',');
                urlQuery += host+'/api/indicatorsFilter?&filtersId.in='+stringResult+'&groupId.equals='+indicadorAtual;

                $.ajax({
                    headers: {
                        "Authorization": "Bearer " + apiKey
                    },
                    url: host+'/api/regionsWithFilter?&filtersId.in='+stringResult,
                    dataType: 'json',
                    success: function (dataJson) {
                        filtrosPesquisados = new Map();
                        dataJson.forEach(function (dto) {
                            var contains = filtrosPesquisados.get(dto.geocode);
                            if(contains === undefined){
                                filtrosPesquisados.set(dto.geocode, []);
                                contains = filtrosPesquisados.get(dto.geocode);
                            }

                            contains.push(dto.filtername);
                        });

                        loadResultMap(urlQuery);
                    }
                });
            }
        }

        $(document).ajaxComplete(function() {
            // limpar Map control
            if (typeof(limparMapControl) != "undefined") {
                limparMapControl.remove(map);
            }
            limparMapControl = L.control({position: 'topright'});
            limparMapControl.onAdd = function (map) {
                this._div = L.DomUtil.create('div', 'limparMapControl');
                this._div.innerHTML = '<div style="cursor: pointer;color:#FFFFFF; font-size:14px;" onclick="limparMap()" class="" id="limparMapControl" title="Menu">' +
                    '<span style="text-decoration: underline;">' +
                    'limpar <span class="fa fa-trash-o"></span>' +
                    '</span></div>';

                L.DomEvent.addListener(this._div, 'dblclick', L.DomEvent.stop);
                L.DomEvent.addListener(this._div, 'mousedown', L.DomEvent.stop);
                L.DomEvent.addListener(this._div, 'mouseup', L.DomEvent.stop);

                return this._div;
            }

            limparMapControl.addTo(map);
        });


    });

};

function infoAboutIndicator() {

    //$('#tituloModal').html("INFORMAÇÕES SOBRE INDICADORES");
    $('#idInfoIndicador').val(indicadorSelecionado);

    $.ajax({
        headers: {
            "Authorization": "Bearer " + apiKey
        },
        url: host+'/api/namesPublic/'+indicadorSelecionado,
        dataType: 'json',
        success: function (dataJson) {
            // create DTO with api name and filters

            var conteudoModal =
                '<div>' +
                '   <div>' +
                '       <div style="margin-bottom: 10px">' +
                '           <label style="margin-right: 5px">' + dataJson.value + ' </label>' +
                // '          <button class="btn btn-outline-info" onclick="loadGraphic(\''+dataJson.name.value+'\')">Ver gráfico</button>' +
                '       <div style="margin-top: 10px" class="infoIndicatorSnippet">' + dataJson.description + '</div>' +
                "       <a href=host+'/api/indicators?&groupId.equals="+indicadorSelecionado+"' download> Download</a>" +
                '       <a href="#" class="mostrarMais"> Ler mais</a>' +
                '   </div>';
            if (filtrosId.size !== 0) {
                conteudoModal +=
                    '<div id="containerDescricaoFiltros">';
                $.ajax({
                    headers: {
                        "Authorization": "Bearer " + apiKey
                    },
                    url: host+'/api/filtersDTO?&id.in='+Array.from(filtrosId).join(','),
                    dataType: 'json',
                    success: function (dataJson) {
                        dataJson.forEach(function (filterInfo) {
                            conteudoModal +=
                                '<div class="card">' +
                                '   <div id="headingFilterInfo' + filterInfo.id + '" data-toggle="collapse" data-target="#collapseFilterInfo' + filterInfo.id + '" aria-expanded="false" aria-controls="collapseFilterInfo' + filterInfo.id + '">' +
                                '       <label class="iconInfoFilter">' + filterInfo.name + '</label>' +
                                '       <i class="fa fa-angle-down"></i>' +
                                '   </div>' +
                                '   <div id="collapseFilterInfo' + filterInfo.id + '" class="collapse" aria-labelledby="headingFilterInfo' + filterInfo.id + '" data-parent="#containerDescricaoFiltros">';
                            conteudoModal +=
                                '       <div class="card-body" style="padding: 0 0 1rem 1rem">' + filterInfo.description + '</div>' +
                                '   </div>' +
                                '</div>';
                        });
                        conteudoModal += '</div> ' +
                            '</div>';
                        $('#modalBody').html(conteudoModal);
                        $('#exampleModal').modal('show');

                        $('.mostrarMais').click(function () {
                            if($('.infoIndicatorSnippet').css('height') != '30px'){
                                $('.infoIndicatorSnippet').stop().animate({height: '30px'}, 200);
                                $(this).text('Ler mais');
                            } else {
                                $('.infoIndicatorSnippet').css({height:'100%'});
                                var xx = $('.infoIndicatorSnippet').height();
                                $('.infoIndicatorSnippet').css({height:'30px'});
                                $('.infoIndicatorSnippet').stop().animate({height: xx}, 400);
                                $(this).text('Ler menos');
                            }
                        });

                        $('#containerDescricaoFiltros .card').on('hidden.bs.collapse', function () {
                            $(this).find( "i" ).removeClass("fa-angle-down");
                            $(this).find( "i" ).addClass("fa-angle-right");
                        });

                        $('#containerDescricaoFiltros .card').on('shown.bs.collapse', function () {
                            $(this).find( "i" ).addClass("fa-angle-down");
                            $(this).find( "i" ).removeClass("fa-angle-right");
                        });
                    }
                });
            } else {
                conteudoModal += '</div>';
                $('#modalBody').html(conteudoModal);
                $('#exampleModal').modal('show');
            }

            $('.mostrarMais').click(function () {
                if($('.infoIndicatorSnippet').css('height') != '30px'){
                    $('.infoIndicatorSnippet').stop().animate({height: '30px'}, 200);
                    $(this).text('Ler mais');
                } else {
                    $('.infoIndicatorSnippet').css({height:'100%'});
                    var xx = $('.infoIndicatorSnippet').height();
                    $('.infoIndicatorSnippet').css({height:'30px'});
                    $('.infoIndicatorSnippet').stop().animate({height: xx}, 400);
                    $(this).text('Ler menos');
                }
            });
        }
    });
}

function loadFiltrosSelecionados(){
    var filtrosSelecionados =
        '<div class="iconFilter float-right" onclick="infoAboutIndicator()" id="filtroMapControl" title="filtro">' +
            '<span class="button-state state-get-center get-center-active robotoFamily">'+
                'Filtros selecionados <span class="fa fa-info"></span>' +
            '</span>'+
        '</div>';

    $("#footer-sidebar-filtros .filtro").html(filtrosSelecionados);

    return filtrosSelecionados;
}
    </script>
</body>
</html>
